{"questions":[{"id":"q-843","question":"Given a CSV file with columns user_id, action, timestamp, write a Python function using only the standard library that returns the most recent action per user by deduplicating on user_id and keeping the latest timestamp; describe time complexity and edge cases?","answer":"Parse the CSV with the csv module, iterate rows, parse timestamp with datetime.fromisoformat, and keep a dict mapping user_id to (timestamp, action). If a row has a newer timestamp, replace the entry.","explanation":"## Why This Is Asked\nTests ability to implement a practical data-processing task: deduplicate by key using timestamps, relies only on standard library, and reveals awareness of edge cases like ties, malformed timestamps, and missing fields.\n\n## Key Concepts\n- CSV parsing with csv module\n- Deduplication by key using a dictionary\n- Timestamp parsing with datetime (ISO 8601)\n- Edge cases: missing fields, invalid timestamps, tie-breaking\n\n## Code Example\n```python\nimport csv\nfrom datetime import datetime\n\ndef latest_actions(csv_path):\n    best = {}\n    with open(csv_path, newline='') as f:\n        rdr = csv.DictReader(f)\n        for row in rdr:\n            uid = row['user_id']\n            ts = row['timestamp']\n            act = row['action']\n            try:\n                t = datetime.fromisoformat(ts)\n            except Exception:\n                continue\n            if uid not in best or t > best[uid][0]:\n                best[uid] = (t, act)\n    return [(uid, act, t.isoformat()) for uid, (t, act) in best.items()]\n```\n\n## Follow-up Questions\n- How would you adapt this for streaming data or files larger than memory?\n- If multiple actions share the same timestamp for a user, how would you break ties and what metadata would you add?","diagram":null,"difficulty":"beginner","tags":["cba"],"channel":"cba","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["OpenAI","PayPal","Twitter"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-12T13:27:05.585Z","createdAt":"2026-01-12T13:27:05.585Z"}],"subChannels":["general"],"companies":["OpenAI","PayPal","Twitter"],"stats":{"total":1,"beginner":1,"intermediate":0,"advanced":0,"newThisWeek":1}}