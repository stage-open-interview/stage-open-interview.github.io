{"questions":[{"id":"q-683","question":"You're managing a streaming DAG with tasks A,B,C,D; edges enforce: A before B; B before C; at most one of C or D can occur in a window of size H. Given a log of events with timestamps per task, implement an O(n log n) verifier to determine if the log is valid under these constraints and describe how you'd extend to multiple windows in a distributed system?","answer":"Sort events by timestamp; maintain last_seen per task; when seeing B, require A has appeared earlier; when C arrives, require B seen within H time; when D arrives, ensure C did not occur in the same w","explanation":"## Why This Is Asked\n\nTests ability to reason about temporal constraints in streaming DAGs and develop an efficient log validation algorithm.\n\n## Key Concepts\n\n- Temporal constraints and causal ordering\n- Sliding window validation\n- O(n log n) sorting and O(1) per-event checks\n- Edge cases: missing prerequisites, mutual exclusion\n\n## Code Example\n\n```javascript\nfunction validLog(events, H) {\n  // events: {task: 'A', t: 0}, ...\n  // naive sketch\n  // sort by t\n  // track last window start, last times\n  // enforce A before B, B before C within H, and at most one of C/D in a window\n}\n```\n\n## Follow-up Questions\n\n- How would you scale to thousands of tasks and multiple horizons?\n- How would clock skew affect correctness and what mitigations exist?","diagram":null,"difficulty":"advanced","tags":["math-logic"],"channel":"math-logic","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["Databricks","Google"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-11T15:58:57.063Z","createdAt":"2026-01-11T15:58:57.063Z"}],"subChannels":["general"],"companies":["Databricks","Google"],"stats":{"total":1,"beginner":0,"intermediate":0,"advanced":1,"newThisWeek":1}}