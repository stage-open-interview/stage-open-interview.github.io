{"questions":[{"id":"q-840","question":"In a secure messaging service, ciphertexts are decrypted by a server with a decryption oracle exposed to clients, creating a potential CCA risk. Design a practical IND-CCA secure scheme for message confidentiality using existing primitives (e.g., OAEP, AES-GCM, MACs). Explain how you prevent chosen-ciphertext attacks, outline a concrete protocol, and discuss trade-offs?","answer":"Use Encrypt-then-MAC: ciphertext = AES-GCM(key, plaintext, nonce) plus a separate MAC over the ciphertext. Verify MAC before decryption and bound decryption attempts to prevent the oracle from learnin","explanation":"## Why This Is Asked\n\nThis checks understanding of IND-CCA security and how to build practical, protocol-level defenses in modern cryptographic systems.\n\n## Key Concepts\n\n- IND-CCA and chosen-ciphertext resistance\n- Encrypt-then-MAC vs MAC-then-Encrypt\n- Nonce management, associated data, and MAC verification order\n- Trade-offs: performance, ciphertext size, API surface\n\n## Code Example\n\n```javascript\nfunction encrypt(plaintext, key) {\n  const nonce = crypto.randomBytes(12);\n  const cipher = crypto.createCipheriv('aes-128-gcm', key, nonce);\n  const enc = Buffer.concat([cipher.update(plaintext, 'utf8'), cipher.final()]);\n  const tag = cipher.getAuthTag();\n  const payload = Buffer.concat([nonce, enc, tag]);\n  const mac = crypto.createHmac('sha256', key).update(payload).digest();\n  return { payload, mac };\n}\n\nfunction decrypt(payload, mac, key) {\n  if (!verifyMac(mac, payload, key)) throw new Error('MAC fail');\n  const nonce = payload.slice(0, 12);\n  const enc = payload.slice(12, -16);\n  const tag = payload.slice(-16);\n  const decipher = crypto.createDecipheriv('aes-128-gcm', key, nonce);\n  decipher.setAuthTag(tag);\n  return Buffer.concat([decipher.update(enc), decipher.final()]);\n}\n```\n\n## Follow-up Questions\n\n- How would you audit for decryption oracle leakage?\n- How would you enforce constant-time MAC checks and retry limits to prevent side channels?","diagram":null,"difficulty":"intermediate","tags":["cca"],"channel":"cca","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["Microsoft","Oracle","Stripe"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-12T13:24:47.474Z","createdAt":"2026-01-12T13:24:47.474Z"}],"subChannels":["general"],"companies":["Microsoft","Oracle","Stripe"],"stats":{"total":1,"beginner":0,"intermediate":1,"advanced":0,"newThisWeek":1}}