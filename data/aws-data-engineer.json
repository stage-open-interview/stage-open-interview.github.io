{"questions":[{"id":"q-886","question":"Scenario: you manage a financial data lake with multiple transactional sources feeding S3 via DMS. Stakeholders require upserts, full history for compliance, fast dashboards using a latest-state table, and seamless schema evolution. Compare Iceberg, Hudi, and Delta Lake for this scenario and outline a concrete pipeline (CDC, ETL, compaction, governance)?","answer":"Use Apache Iceberg on S3 to support CDC upserts and full history. Ingest via DMS into a staging Parquet layer, then Spark MERGE INTO to the Iceberg table; maintain a separate 'latest' snapshot for das","explanation":"## Why This Is Asked\nFinancial data lakes require reliable upserts, auditability, and governance. This question probes familiarity with lakehouse formats and practical pipeline design.\n\n## Key Concepts\n- Change Data Capture (CDC) via DMS into S3-backed lakehouse\n- Upserts and history with Iceberg vs Hudi/Delta\n- Schema evolution and partitioning strategy\n- Data governance and validation checks\n\n## Code Example\n```javascript\nCREATE TABLE analytics.fact_sales (\n  id BIGINT,\n  amount DECIMAL(12,2),\n  ts TIMESTAMP,\n  source STRING\n)\nUSING ICEBERG\nPARTITIONED BY (years(ts), months(ts), source);\n\nMERGE INTO analytics.fact_sales_latest AS target\nUSING analytics.fact_sales_staging AS src\nON target.id = src.id\nWHEN MATCHED THEN UPDATE SET amount = src.amount, ts = src.ts\nWHEN NOT MATCHED THEN INSERT (id, amount, ts, source) VALUES (src.id, src.amount, src.ts, src.source);\n```\n\n## Follow-up Questions\n- How would you handle late-arriving data and out-of-order events?\n- What monitoring would you implement for compaction and schema changes?","diagram":"flowchart TD\n  A[CDC Source] --> B[Staging Parquet]\n  B --> C[Spark MERGE to Iceberg]\n  C --> D[Latest Snapshot]\n  D --> E[Athena/BI Dashboards]","difficulty":"intermediate","tags":["aws-data-engineer"],"channel":"aws-data-engineer","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["Goldman Sachs","Tesla"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-12T14:25:05.485Z","createdAt":"2026-01-12T14:25:05.485Z"},{"id":"q-948","question":"In a multi-tenant data lake on S3 across two AWS accounts, each tenant's data must be isolated, with auditable access, cost accounting, and fast analytics for dashboards. Design a solution using AWS Lake Formation for governance, S3 prefixes per tenant, and Athena/Glue for analytics. Explain cross-account sharing, tag-based access, and data lineage, plus failure modes?","answer":"Use Lake Formation governance with per-tenant databases mapped to S3 prefixes (s3://lake/tenant-id/...). Expose cross-account access via resource links and tag-based ACLs, audited by Lake Formation an","explanation":"## Why This Is Asked\nTests mastery of cross-account governance, tenant isolation, auditable access, and cost reporting in a real-world data lake.\n\n## Key Concepts\n- Lake Formation governance and resource links\n- Per-tenant S3 prefixes and Glue Data Catalog\n- Tag-based access control and cost allocation\n- Cross-account sharing and CloudTrail/audit trails\n- Data lineage and auditability\n\n## Code Example\n```bash\n# Grant a tenant role read on its catalog table (illustrative)\naws lakeformation grant-permissions --principal '{\"EffectiveFrom\": \"2026-01-12T00:00:00Z\",\"DataLakePrincipalIdentifier\": \"arn:aws:iam::111122223333:role/tenantA\"}' --permissions SELECT --resource '{\"Table\": {\"DatabaseName\": \"tenantA_db\", \"Name\": \"events\"}}'\n```\n\n## Follow-up Questions\n- How would you handle offboarding a tenant's data while preserving analytics history?\n- How would you test isolation and audit completeness in CI/CD?\n","diagram":null,"difficulty":"advanced","tags":["aws-data-engineer"],"channel":"aws-data-engineer","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["Apple","Discord","Netflix"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-12T16:36:54.412Z","createdAt":"2026-01-12T16:36:54.412Z"}],"subChannels":["general"],"companies":["Apple","Discord","Goldman Sachs","Netflix","Tesla"],"stats":{"total":2,"beginner":0,"intermediate":1,"advanced":1,"newThisWeek":2}}