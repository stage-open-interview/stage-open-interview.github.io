{"questions":[{"id":"q-682","question":"In a service handling image uploads, each file triggers a resize and thumbnail generation pipeline. Design a bounded producer-consumer queue in Python using asyncio. Use a Queue with maxsize, a fixed number of worker coroutines, and backpressure so producers await when full. Include clean shutdown and error handling. Provide a runnable minimal example showing enqueue, worker loop, and cancellation?","answer":"Use an asyncio.Queue(maxsize=128) with 4 worker coroutines. Producers await queue.put(task) to apply backpressure. Each worker pops tasks, processes image transforms, then calls queue.task_done(). On ","explanation":"## Why This Is Asked\n\nAssesses practical concurrency skills: bounded queues, worker pools, backpressure, and robust shutdown in a real feature like image processing.\n\n## Key Concepts\n\n- asyncio.Queue(maxsize) and backpressure\n- fixed-size worker pool\n- graceful shutdown and cancellation\n- error handling and observability\n\n## Code Example\n\n```python\n# Minimal outline of the pattern (not a full solution)\nimport asyncio\n\nclass Task:\n    def __init__(self, data): self.data = data\n\nasync def worker(q):\n    while True:\n        t = await q.get()\n        try:\n            # process t\n            pass\n        finally:\n            q.task_done()\n\nasync def main():\n    q = asyncio.Queue(maxsize=128)\n    workers = [asyncio.create_task(worker(q)) for _ in range(4)]\n    # enqueue tasks\n    for item in range(10):\n        await q.put(Task(item))\n    await q.join()\n    for w in workers: w.cancel()\n\nasyncio.run(main())\n```\n\n## Follow-up Questions\n\n- How would you adjust for burst traffic without starving producers?\n- How can you monitor queue depth and worker latency in production?","diagram":null,"difficulty":"beginner","tags":["concurrency"],"channel":"concurrency","subChannel":"general","sourceUrl":null,"videos":{"shortVideo":null,"longVideo":null},"companies":["Discord","Lyft","Snap"],"eli5":null,"relevanceScore":null,"voiceKeywords":null,"voiceSuitable":false,"isNew":false,"lastUpdated":"2026-01-11T15:58:30.388Z","createdAt":"2026-01-11T15:58:30.388Z"}],"subChannels":["general"],"companies":["Discord","Lyft","Snap"],"stats":{"total":1,"beginner":1,"intermediate":0,"advanced":0,"newThisWeek":1}}