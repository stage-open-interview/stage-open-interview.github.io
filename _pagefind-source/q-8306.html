<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>In a PostgreSQL-based wallet service, you have tables accounts(id PRIMARY KEY, balance NUMERIC), transfers(id PRIMARY KEY, from_id REFERENCES accounts(id), to_id REFERENCES accounts(id), amount NUMERIC, created_at TIMESTAMPTZ, status TEXT). Design a transfer(from_id, to_id, amount) that uses MVCC to guarantee atomic debit and credit under high contention. Specify the isolation level, locking strategy (e.g., SELECT ... FOR UPDATE), and how you would test for phantom reads and write skew?</title>
  <meta name="description" content="">
</head>
<body>
  <article data-pagefind-body>
    <h1 data-pagefind-meta="title">In a PostgreSQL-based wallet service, you have tables accounts(id PRIMARY KEY, balance NUMERIC), transfers(id PRIMARY KEY, from_id REFERENCES accounts(id), to_id REFERENCES accounts(id), amount NUMERIC, created_at TIMESTAMPTZ, status TEXT). Design a transfer(from_id, to_id, amount) that uses MVCC to guarantee atomic debit and credit under high contention. Specify the isolation level, locking strategy (e.g., SELECT ... FOR UPDATE), and how you would test for phantom reads and write skew?</h1>
    
    <div data-pagefind-filter="channel">database</div>
    <div data-pagefind-filter="difficulty">intermediate</div>
    <div data-pagefind-filter="topic">Transactions</div>
    
    <div data-pagefind-meta="channel" data-pagefind-meta-value="database"></div>
    <div data-pagefind-meta="difficulty" data-pagefind-meta-value="intermediate"></div>
    <div data-pagefind-meta="id" data-pagefind-meta-value="q-8306"></div>
    
    <main>
      <section class="answer">
        
      </section>
      
      
      <section class="tags">
        <span>acid</span> <span>isolation-levels</span> <span>mvcc</span>
      </section>
      
      
      
      <section class="companies" data-pagefind-filter="company">
        <span>Discord</span> <span>Twitter</span> <span>Uber</span>
      </section>
      
    </main>
  </article>
</body>
</html>