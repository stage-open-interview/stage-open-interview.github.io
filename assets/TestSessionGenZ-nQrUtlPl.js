import{e as q,u as H,r as d,j as e,m as C,Z as M,H as W,A as X,X as Y,f as _,T as J,h as $}from"./index-DnNCriBO.js";import{S as K}from"./SEOHead-Cf-C8o-e.js";import{D as U}from"./DesktopSidebarWrapper-D8Y-aTld.js";import{G as o,a as A}from"./GenZButton-l6iWAZVQ.js";import{g as V,a as ee,b as P,c as se,d as te,e as re,s as ne}from"./tests-DRPiStcq.js";import{C as E}from"./check-Jiyy2YjJ.js";import{A as ae}from"./UnifiedSearch-DixOZ04U.js";import{C as ie}from"./circle-x-DLzoBnHr.js";import"./UnifiedNav-DxiBfMXK.js";import"./use-unified-toast-DZmB-CSH.js";import"./tag--hQ6BGuG.js";import"./chart-column-CJDhOuOb.js";import"./user-D_7neW7P.js";function ye(){const{channelId:u}=q(),[le,j]=H(),[r,I]=d.useState(null),[b,g]=d.useState("loading"),[i,O]=d.useState([]),[n,p]=d.useState(0),[l,N]=d.useState({}),[z,D]=d.useState(0),[c,S]=d.useState(null),[f,y]=d.useState(null);d.useEffect(()=>{u&&V(u).then(t=>{t?(I(t),g("ready")):g("loading")})},[u]);const s=i[n],v=ee(r?.id||""),G=r?P(r.channelId):P("default"),Q=r&&v?se(r,v):!1,k=d.useCallback(()=>{if(!r)return;const t=te(r,15);O(t),N({}),p(0),D(Date.now()),S(null),g("in-progress")},[r]),R=t=>{if(!s)return;const a=l[s.id]||[];if(s.type==="single"){const m={...l,[s.id]:[t]};N(m);const w=s.options.find(x=>x.isCorrect)?.id===t;y(w?"correct":"incorrect"),setTimeout(()=>{y(null),n<i.length-1&&p(n+1)},600)}else a.includes(t)?N({...l,[s.id]:a.filter(m=>m!==t)}):N({...l,[s.id]:[...a,t]})},T=()=>{if(!s||s.type!=="multiple")return;const t=l[s.id]||[];if(t.length===0)return;const a=s.options.filter(x=>x.isCorrect).map(x=>x.id),m=a.every(x=>t.includes(x)),h=t.every(x=>a.includes(x));y(m&&h?"correct":"incorrect"),setTimeout(()=>{y(null),n<i.length-1&&p(n+1)},800)},Z=()=>{n<i.length-1&&p(n+1)},B=()=>{n>0&&p(n-1)},F=()=>{if(!r)return;const t=re({...r,questions:i},l);S(t);const a={testId:r.id,startedAt:new Date(z).toISOString(),completedAt:new Date().toISOString(),answers:l,score:t.score,passed:t.passed};ne(r.id,r.channelId,a,r.version),g("review"),t.passed?$.celebrate():$.disappointed()},L=Object.keys(l).length;return b==="loading"||!r?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:r?"Loading test...":"No test available for this channel yet"}),e.jsx(o,{onClick:()=>j("/"),className:"mt-4",children:"Go back home"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(K,{title:`${r.title} | Code Reels`,description:r.description,canonical:`https://open-interview.github.io/test/${u}`}),e.jsx(U,{children:e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[b==="ready"&&e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-md w-full",children:e.jsxs(A,{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-primary to-cyan-500 flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-3xl",children:G.icon})}),e.jsx("h1",{className:"text-xl font-bold mb-2 text-foreground",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]}),e.jsxs("div",{className:"space-y-3 mb-6 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 rounded bg-muted/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Questions"}),e.jsxs("span",{className:"font-bold",children:["15 (random from ",r.questions.length,")"]})]}),e.jsxs("div",{className:"flex justify-between p-2 rounded bg-muted/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Passing Score"}),e.jsxs("span",{className:"font-bold",children:[r.passingScore,"%"]})]}),v&&!Q&&e.jsxs("div",{className:"flex justify-between p-2 bg-[#00ff88]/10 rounded border border-primary/30",children:[e.jsx("span",{className:"text-muted-foreground",children:"Your Best"}),e.jsxs("span",{className:"font-bold text-primary",children:[v.bestScore,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{onClick:k,className:"w-full",children:[e.jsx(M,{className:"w-5 h-5 mr-2"})," Start Test"]}),e.jsx(o,{variant:"secondary",onClick:()=>j(`/channel/${u}`),className:"w-full",children:"Back to Channel"})]})]})})}),b==="in-progress"&&s&&e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("header",{className:"border-b border-border p-2.5 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j("/"),className:"flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(W,{className:"w-3.5 h-3.5"})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n+1,"/",i.length]}),e.jsx("div",{className:"h-1 w-20 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#00ff88] transition-all",style:{width:`${(n+1)/i.length*100}%`}})})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[L,"/",i.length]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(X,{mode:"wait",children:e.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:`px-2 py-0.5 text-[10px] uppercase rounded ${s.type==="multiple"?"bg-[#ff0080]/20 text-[#ff0080]":"bg-[#00d4ff]/20 text-cyan-500"}`,children:s.type==="multiple"?"Select all that apply":"Single choice"}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] uppercase rounded ${s.difficulty==="beginner"?"bg-[#00ff88]/20 text-primary":s.difficulty==="intermediate"?"bg-[#ffd700]/20 text-[#ffd700]":"bg-[#ff0080]/20 text-[#ff0080]"}`,children:s.difficulty})]}),e.jsx("h2",{className:"text-lg font-bold mb-6",children:s.question}),e.jsx("div",{className:"space-y-2",children:s.options.map(t=>{const a=(l[s.id]||[]).includes(t.id),m=f&&t.isCorrect,h=f==="incorrect"&&a&&!t.isCorrect,w=s.type==="multiple";return e.jsx("button",{onClick:()=>R(t.id),disabled:f!==null,className:`w-full p-4 text-left border rounded-lg transition-all ${m?"border-primary bg-[#00ff88]/20":h?"border-[#ff0080] bg-[#ff0080]/20":a?"border-primary bg-[#00ff88]/10":"border-border hover:border-primary/50"} ${f?"cursor-default":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`w-6 h-6 ${w?"rounded-md":"rounded-full"} border-2 flex items-center justify-center flex-shrink-0 ${m?"border-primary bg-[#00ff88]":h?"border-[#ff0080] bg-[#ff0080]":a?"border-primary bg-[#00ff88]":"border-white/30"}`,children:[m&&e.jsx(E,{className:"w-4 h-4 text-black"}),h&&e.jsx(Y,{className:"w-4 h-4 text-foreground"}),!f&&a&&e.jsx(E,{className:"w-4 h-4 text-black"})]}),e.jsx("span",{className:"text-sm",children:t.text})]})},t.id)})}),s.type==="multiple"&&!f&&e.jsx("p",{className:"mt-3 text-xs text-muted-foreground text-center",children:'Select all correct answers, then click "Confirm" to continue'})]},s.id)})})}),e.jsx("footer",{className:"border-t border-border p-2",children:e.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between gap-2",children:[e.jsxs(o,{size:"sm",variant:"secondary",onClick:B,disabled:n===0,children:[e.jsx(_,{className:"w-3.5 h-3.5 mr-1"}),"Prev"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:n+1}),e.jsx("span",{children:"/"}),e.jsx("span",{children:i.length})]}),n===i.length-1?s?.type==="multiple"?e.jsx(o,{size:"sm",onClick:T,disabled:(l[s.id]||[]).length===0||f!==null,children:"Submit"}):e.jsx(o,{size:"sm",onClick:F,children:"Submit"}):s?.type==="multiple"?e.jsx(o,{size:"sm",onClick:T,disabled:(l[s.id]||[]).length===0||f!==null,children:"Confirm"}):e.jsxs(o,{size:"sm",variant:"secondary",onClick:Z,disabled:n>=i.length-1,children:["Next",e.jsx(ae,{className:"w-3.5 h-3.5 ml-1"})]})]})})]}),b==="review"&&c&&e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-md w-full",children:e.jsx(A,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-24 h-24 rounded-2xl flex items-center justify-center mx-auto mb-6 ${c.passed?"bg-[#00ff88]/20":"bg-[#ff0080]/20"}`,children:c.passed?e.jsx(J,{className:"w-12 h-12 text-primary"}):e.jsx(ie,{className:"w-12 h-12 text-[#ff0080]"})}),e.jsxs("div",{className:"text-6xl font-black text-foreground mb-2",children:[c.score,"%"]}),e.jsx("p",{className:`text-xl font-semibold mb-8 ${c.passed?"text-primary":"text-[#ff0080]"}`,children:c.passed?"Passed!":"Not Passed"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-background/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:c.correct}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Correct"})]}),e.jsxs("div",{className:"bg-background/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-[#ff0080]",children:c.total-c.correct}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Incorrect"})]})]}),e.jsxs("div",{className:"space-y-2",children:[!c.passed&&e.jsx(o,{onClick:k,className:"w-full",children:"Try Again"}),e.jsx(o,{variant:"secondary",onClick:()=>j(`/channel/${u}`),className:"w-full",children:"Back to Channel"})]})]})})})})]})})]})}export{ye as default};
