import{c as Z,g as de,r as d,u as ae,q as ne,O as re,f as ie,j as e,A as G,m as A,X as D,Z as H,ai as xe,F as le}from"./index-DaVim63q.js";import{getAllChallenges as ue}from"./coding-challenges-D2b0VtNy.js";import{C as J,a as O,G as ee,T as me}from"./tag-Dv-3imZU.js";import{T as Y}from"./target-CN6vs2YH.js";import{A as X}from"./arrow-right-CPirRxXj.js";import{L as B}from"./loader-circle-LN3j_L4i.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],oe=Z("funnel",he);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],k=Z("search",pe);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],te=Z("video",fe);function S(i,x){const l=i.toLowerCase(),c=x.toLowerCase();if(c===l)return 1e3;if(c.includes(l))return 500+(100-x.length);const n=l.split(/\s+/).filter(o=>o.length>1),u=c.split(/\s+/);let r=0,p=0;for(const o of n){let f=!1;for(const m of u){if(m===o){r+=50,f=!0;break}if(m.startsWith(o)){r+=30,f=!0;break}if(m.includes(o)){r+=15,f=!0;break}}f?(p++,r+=p*5):p=0}if(r===0&&l.length>=3){let o=0,f=-1;for(const m of l){const g=c.indexOf(m,f+1);g>-1&&(o+=1,g===f+1&&(o+=.5),f=g)}o>=l.length*.6&&(r=o)}return r}function ge(i,x=20){if(!i||i.trim().length<2)return[];const l=de(),c=new Map;for(const u of l){const r=c.get(u.id),p=[];let o=0;const f=S(i,u.question);f>0&&(o+=f*3,p.push("question"));const m=S(i,u.answer);m>0&&(o+=m*1.5,p.push("answer"));const g=u.tags?.join(" ")||"",b=S(i,g);b>0&&(o+=b*2,p.push("tags"));const v=`${u.channel} ${u.subChannel}`.replace(/-/g," "),w=S(i,v);w>0&&(o+=w*1.5,p.push("channel")),o>0&&(!r||o>r.score)&&c.set(u.id,{question:u,score:o,matchedIn:p,type:"question"})}const n=Array.from(c.values());return n.sort((u,r)=>r.score-u.score),n.slice(0,x)}function be(i,x=10){if(!i||i.trim().length<2)return[];const l=ue(),c=[];for(const n of l){const u=[];let r=0;const p=S(i,n.title);p>0&&(r+=p*3,u.push("title"));const o=S(i,n.description);o>0&&(r+=o*1.5,u.push("description"));const f=n.tags?.join(" ")||"",m=S(i,f);m>0&&(r+=m*2,u.push("tags"));const g=S(i,n.category.replace(/-/g," "));g>0&&(r+=g*1.5,u.push("category")),r>0&&c.push({challenge:n,score:r,matchedIn:u,type:"coding"})}return c.sort((n,u)=>u.score-n.score),c.slice(0,x)}function ye(i,x=20){const l=ge(i,x),c=be(i,Math.floor(x/2)),n=[...l,...c];return n.sort((u,r)=>r.score-u.score),n.slice(0,x)}function ce(i,x){const[l,c]=d.useState(i);return d.useEffect(()=>{const n=setTimeout(()=>{c(i)},x);return()=>{clearTimeout(n)}},[i,x]),l}function T(i){return i.type==="question"}function K(i){return i.type==="coding"}function je({isOpen:i,onClose:x}){const[l,c]=d.useState(""),[n,u]=d.useState([]),[r,p]=d.useState([]),[o,f]=d.useState(0),[m,g]=d.useState(!1),[b,v]=d.useState("all"),w=d.useRef(null),M=d.useRef(null),[,N]=ae(),{isSubscribed:P,subscribeChannel:L}=ne(),{toast:U}=re(),C=ce(l,150),q=[{id:"all",label:"All",icon:e.jsx(oe,{className:"w-3 h-3"})},{id:"coding",label:"Coding",icon:e.jsx(J,{className:"w-3 h-3"})},{id:"company",label:"Company",icon:e.jsx(O,{className:"w-3 h-3"})},{id:"video",label:"Video",icon:e.jsx(te,{className:"w-3 h-3"})},{id:"diagram",label:"Diagram",icon:e.jsx(ee,{className:"w-3 h-3"})}];d.useEffect(()=>{i&&(setTimeout(()=>{w.current?.focus(),M.current?.focus()},100),c(""),u([]),p([]),f(0),v("all"))},[i]),d.useEffect(()=>{if(C.length>=2){g(!0);const t=ye(C,50);u(t),f(0),g(!1)}else u([])},[C]),d.useEffect(()=>{let t=n;switch(b){case"coding":t=n.filter(s=>K(s));break;case"company":t=n.filter(s=>T(s)&&s.question.companies&&s.question.companies.length>0);break;case"video":t=n.filter(s=>T(s)&&(s.question.videos?.shortVideo||s.question.videos?.longVideo));break;case"diagram":t=n.filter(s=>T(s)&&(s.question.diagram?.length??0)>20);break;default:t=n}p(t.slice(0,15)),f(0)},[n,b]);const V=d.useCallback(t=>{t.key==="ArrowDown"?(t.preventDefault(),f(s=>Math.min(s+1,r.length-1))):t.key==="ArrowUp"?(t.preventDefault(),f(s=>Math.max(s-1,0))):t.key==="Enter"&&r[o]?(t.preventDefault(),F(r[o])):t.key==="Escape"&&x()},[r,o,x]),F=t=>{if(K(t)){N(`/coding/${t.challenge.id}`),x();return}const{question:s}=t;if(!P(s.channel)){L(s.channel);const R=ie.find(a=>a.id===s.channel);U({title:"Channel Subscribed",description:`You've been subscribed to ${R?.name||s.channel}`})}N(`/channel/${s.channel}/${s.id}`),x()},W=t=>{switch(t){case"beginner":return e.jsx(H,{className:"w-3 h-3 text-green-400"});case"intermediate":return e.jsx(Y,{className:"w-3 h-3 text-yellow-400"});case"advanced":return e.jsx(le,{className:"w-3 h-3 text-red-400"});default:return null}},Q=t=>t==="all"?n.length:t==="coding"?n.filter(s=>K(s)).length:t==="company"?n.filter(s=>T(s)&&s.question.companies?.length).length:t==="video"?n.filter(s=>T(s)&&(s.question.videos?.shortVideo||s.question.videos?.longVideo)).length:t==="diagram"?n.filter(s=>T(s)&&(s.question.diagram?.length??0)>20).length:0,$=(t,s)=>{if(K(t))return e.jsxs("button",{onClick:()=>F(t),className:`w-full px-4 py-4 text-left flex items-start gap-3 transition-colors active:bg-primary/10 ${s===o?"bg-primary/20":"hover:bg-muted/50"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.challenge.difficulty==="easy"?e.jsx(H,{className:"w-3 h-3 text-green-400"}):e.jsx(Y,{className:"w-3 h-3 text-yellow-400"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:["coding/",t.challenge.category]}),e.jsxs("span",{className:"flex items-center gap-0.5 text-[9px] text-purple-600 dark:text-purple-400 bg-purple-400/10 px-1.5 py-0.5 rounded ml-auto",children:[e.jsx(J,{className:"w-2.5 h-2.5"})," Challenge"]})]}),e.jsx("p",{className:"text-sm text-foreground line-clamp-2",children:t.challenge.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-1",children:t.challenge.description})]}),e.jsx(X,{className:`w-4 h-4 shrink-0 mt-1 ${s===o?"text-primary":"text-muted-foreground/30"}`})]},`coding-${t.challenge.id}-${s}`);const R=(t.question.companies?.length??0)>0,a=t.question.videos?.shortVideo||t.question.videos?.longVideo,h=(t.question.diagram?.length??0)>20;return e.jsxs("button",{onClick:()=>F(t),className:`w-full px-4 py-4 text-left flex items-start gap-3 transition-colors active:bg-primary/10 ${s===o?"bg-primary/20":"hover:bg-muted/50"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[W(t.question.difficulty),e.jsxs("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:[t.question.channel,"/",t.question.subChannel]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[R&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[9px] text-blue-600 dark:text-blue-400 bg-blue-400/10 px-1.5 py-0.5 rounded",children:[e.jsx(O,{className:"w-2.5 h-2.5"}),t.question.companies.length]}),a&&e.jsx("span",{className:"flex items-center text-[9px] text-red-600 dark:text-red-400 bg-red-400/10 px-1.5 py-0.5 rounded",children:e.jsx(te,{className:"w-2.5 h-2.5"})}),h&&e.jsx("span",{className:"flex items-center text-[9px] text-green-600 dark:text-green-400 bg-green-400/10 px-1.5 py-0.5 rounded",children:e.jsx(ee,{className:"w-2.5 h-2.5"})})]})]}),e.jsx("p",{className:"text-sm text-foreground line-clamp-2",children:t.question.question}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-1",children:t.question.answer}),t.question.tags?.length>0&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(me,{className:"w-3 h-3 text-muted-foreground/50"}),e.jsx("span",{className:"text-[10px] text-muted-foreground/50",children:t.question.tags.slice(0,3).map(xe).join(", ")})]})]}),e.jsx(X,{className:`w-4 h-4 shrink-0 mt-1 ${s===o?"text-primary":"text-muted-foreground/30"}`})]},`question-${t.question.id}-${s}`)},z=()=>e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-base mb-1",children:"Type to search"}),e.jsx("p",{className:"text-sm opacity-70 mb-6",children:"Search questions, topics, or tags"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:["react hooks","system design","sql joins","kubernetes"].map(t=>e.jsx("button",{onClick:()=>c(t),className:"px-4 py-2 text-sm bg-muted hover:bg-muted/80 border border-border rounded-full transition-colors active:scale-95",children:t},t))})]}),I=()=>e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsxs("p",{className:"text-base",children:['No results for "',l,'"']}),e.jsx("p",{className:"text-sm mt-2 opacity-70",children:"Try different keywords"})]});return i?e.jsx(G,{children:i&&e.jsxs(e.Fragment,{children:[e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"lg:hidden fixed inset-0 z-[200] bg-black/95 backdrop-blur-xl flex flex-col",style:{top:0,left:0,right:0,bottom:0,position:"fixed"},"data-testid":"search-modal-mobile",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 h-14 border-b border-white/10 flex-shrink-0",children:[e.jsx("h2",{className:"font-semibold text-lg text-white",children:"Search"}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 hover:bg-white/10 rounded-xl transition-colors","data-testid":"search-close-btn",children:e.jsx(D,{className:"w-5 h-5 text-white/70"})})]}),e.jsx("div",{className:"px-4 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white/5 border border-white/10 rounded-2xl",children:[e.jsx(k,{className:"w-5 h-5 text-white/50 flex-shrink-0"}),e.jsx("input",{ref:M,type:"text",value:l,onChange:t=>c(t.target.value),onKeyDown:V,placeholder:"Search questions...",className:"flex-1 bg-transparent text-white text-base outline-none placeholder:text-white/30",autoComplete:"off",spellCheck:!1,"data-testid":"search-input-mobile"}),l&&e.jsx("button",{onClick:()=>c(""),className:"p-1.5 hover:bg-white/10 rounded-full flex-shrink-0",children:e.jsx(D,{className:"w-4 h-4 text-white/50"})})]})}),n.length>0&&e.jsx("div",{className:"flex items-center gap-2 px-4 py-2 overflow-x-auto no-scrollbar flex-shrink-0",children:q.map(t=>{const s=Q(t.id);return e.jsxs("button",{onClick:()=>v(t.id),disabled:s===0&&t.id!=="all",className:`flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-full transition-all flex-shrink-0 ${b===t.id?"bg-primary text-white font-semibold":s>0?"bg-white/10 text-white/70":"bg-white/5 text-white/30"}`,children:[t.icon," ",t.label," (",s,")"]},t.id)})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[m&&e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary/30 border-t-primary rounded-full animate-spin mx-auto"})}),!m&&l.length>=2&&r.length===0&&I(),!m&&r.length>0&&e.jsx("div",{className:"py-2",children:r.map((t,s)=>$(t,s))}),!m&&l.length<2&&z()]}),e.jsx("div",{className:"px-4 py-3 border-t border-white/10 flex-shrink-0",style:{paddingBottom:"max(env(safe-area-inset-bottom), 12px)"},children:e.jsx("p",{className:"text-sm text-white/40 text-center",children:r.length>0?`${r.length} results`:"Tap to search"})})]}),e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden lg:flex fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm items-start justify-center pt-[10vh] px-4",onClick:x,"data-testid":"search-modal-desktop",children:e.jsxs(A.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:"w-full max-w-2xl bg-card border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-border",children:[e.jsx(k,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("input",{ref:w,type:"text",value:l,onChange:t=>c(t.target.value),onKeyDown:V,placeholder:"Search questions, topics, tags...",className:"flex-1 bg-transparent text-foreground text-lg outline-none placeholder:text-muted-foreground/50",autoComplete:"off",spellCheck:!1,"data-testid":"search-input-desktop"}),l&&e.jsx("button",{onClick:()=>c(""),className:"p-1.5 hover:bg-muted rounded-full",children:e.jsx(D,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("kbd",{className:"px-2 py-1 text-[10px] text-muted-foreground bg-muted border border-border rounded",children:"ESC"})]}),n.length>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-border bg-muted/30 flex-wrap",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider mr-1",children:"Filter:"}),q.map(t=>{const s=Q(t.id);return e.jsxs("button",{onClick:()=>v(t.id),disabled:s===0&&t.id!=="all",className:`flex items-center gap-1.5 px-2.5 py-1 text-[11px] rounded-full transition-all ${b===t.id?"bg-primary text-primary-foreground font-bold":s>0?"bg-muted text-muted-foreground hover:bg-muted/80":"bg-muted/50 text-muted-foreground/50 cursor-not-allowed"}`,children:[t.icon," ",t.label," ",e.jsxs("span",{className:"text-[9px] opacity-70",children:["(",s,")"]})]},t.id)})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[m&&e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary/30 border-t-primary rounded-full animate-spin mx-auto"})}),!m&&l.length>=2&&r.length===0&&I(),!m&&r.length>0&&e.jsx("div",{className:"py-2",children:r.map((t,s)=>$(t,s))}),!m&&l.length<2&&z()]}),e.jsxs("div",{className:"px-4 py-3 border-t border-border flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"↑↓"})," Navigate"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"↵"})," Select"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"ESC"})," Close"]})]}),r.length>0&&e.jsxs("span",{children:[r.length," results"]})]})]})})]})}):null}function we({isOpen:i,onClose:x}){const[l,c]=d.useState(""),[n,u]=d.useState([]),[r,p]=d.useState(0),[o,f]=d.useState(!1),[m,g]=d.useState(!0),[b,v]=d.useState(null),[w,M]=d.useState({}),[N,P]=d.useState(null),[L,U]=d.useState(!1),C=d.useRef(null),q=d.useRef(null),[,V]=ae(),{isSubscribed:F,subscribeChannel:W}=ne(),{toast:Q}=re(),$=ce(l,200);d.useEffect(()=>{const a=()=>U(window.innerWidth<1024);return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),d.useEffect(()=>{async function a(){try{if(!document.querySelector('link[href*="pagefind"]')){const j=document.createElement("link");j.rel="stylesheet",j.href="/pagefind/pagefind-ui.css",document.head.appendChild(j)}if(!window.pagefind){await new Promise((E,_)=>{const y=document.createElement("script");y.src="/pagefind/pagefind.js",y.type="module",y.onload=()=>E(),y.onerror=()=>_(new Error("Failed to load Pagefind script")),document.head.appendChild(y)});let j=0;for(;!window.pagefind&&j<50;)await new Promise(E=>setTimeout(E,100)),j++}if(!window.pagefind)throw new Error("Pagefind not available");await window.pagefind.init(),q.current=window.pagefind;const h=await window.pagefind.filters();M(h),g(!1),v(null)}catch(h){console.error("Failed to load Pagefind:",h),v("Search index not available. Using fallback search."),g(!1)}}i&&!q.current&&a()},[i]),d.useEffect(()=>{i&&(setTimeout(()=>C.current?.focus(),100),c(""),u([]),p(0),P(null))},[i]),d.useEffect(()=>{async function a(){if(!q.current||$.length<2){u([]);return}f(!0);try{const h={};N&&(h.filters={difficulty:N});const j=await q.current.search($,h),E=await Promise.all(j.results.slice(0,15).map(async _=>{const y=await _.data();return{id:y.meta.id||_.id,title:y.meta.title,excerpt:y.excerpt,channel:y.meta.channel||"",difficulty:y.meta.difficulty||"intermediate"}}));u(E),p(0)}catch(h){console.error("Search error:",h)}finally{f(!1)}}a()},[$,N]);const z=d.useCallback(a=>{a.key==="ArrowDown"?(a.preventDefault(),p(h=>Math.min(h+1,n.length-1))):a.key==="ArrowUp"?(a.preventDefault(),p(h=>Math.max(h-1,0))):a.key==="Enter"&&n[r]?(a.preventDefault(),I(n[r])):a.key==="Escape"&&x()},[n,r,x]),I=a=>{const h=a.channel;if(h&&!F(h)){W(h);const j=ie.find(E=>E.id===h);Q({title:"Channel Subscribed",description:`You've been subscribed to ${j?.name||h}`})}h&&V(`/channel/${h}/${a.id}`),x()},t=a=>{switch(a){case"beginner":return e.jsx(H,{className:"w-3 h-3 text-green-400"});case"intermediate":return e.jsx(Y,{className:"w-3 h-3 text-yellow-400"});case"advanced":return e.jsx(le,{className:"w-3 h-3 text-red-400"});default:return null}},s=()=>!w.difficulty||Object.keys(w.difficulty).length===0?null:e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 border-b border-border bg-muted/30 overflow-x-auto no-scrollbar flex-shrink-0 ${L?"":"flex-wrap"}`,children:[!L&&e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider mr-1",children:"Difficulty:"}),e.jsxs("button",{onClick:()=>P(null),className:`flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-full transition-all flex-shrink-0 ${N?"bg-muted text-muted-foreground hover:bg-muted/80":"bg-primary text-primary-foreground font-semibold"}`,children:[e.jsx(oe,{className:"w-3 h-3"})," All"]}),Object.entries(w.difficulty).map(([a,h])=>e.jsxs("button",{onClick:()=>P(N===a?null:a),className:`flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-full transition-all flex-shrink-0 ${N===a?"bg-primary text-primary-foreground font-semibold":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:[t(a)," ",a," (",h,")"]},a))]}),R=()=>e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o&&e.jsx("div",{className:"p-8 text-center",children:e.jsx(B,{className:"w-6 h-6 animate-spin mx-auto text-muted-foreground"})}),!o&&l.length>=2&&n.length===0&&e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsxs("p",{className:"text-base",children:['No questions found for "',l,'"']}),e.jsx("p",{className:"text-sm mt-2 opacity-70",children:"Try different keywords"})]}),!o&&n.length>0&&e.jsx("div",{className:"py-2",children:n.map((a,h)=>e.jsxs("button",{onClick:()=>I(a),className:`w-full px-4 py-4 text-left flex items-start gap-3 transition-colors active:bg-primary/10 ${h===r?"bg-primary/20":"hover:bg-muted/50"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t(a.difficulty),e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:a.channel})]}),e.jsx("p",{className:"text-sm text-foreground line-clamp-2",children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mt-1",dangerouslySetInnerHTML:{__html:a.excerpt}})]}),e.jsx(X,{className:`w-4 h-4 shrink-0 mt-1 ${h===r?"text-primary":"text-muted-foreground/30"}`})]},a.id))}),!o&&l.length<2&&!m&&e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-base mb-1",children:"Type at least 2 characters"}),e.jsx("p",{className:"text-sm opacity-70 mb-6",children:"Search questions, topics, or tags"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:["react hooks","system design","sql joins","kubernetes"].map(a=>e.jsx("button",{onClick:()=>c(a),className:"px-4 py-2 text-sm bg-muted hover:bg-muted/80 border border-border rounded-full transition-colors active:scale-95",children:a},a))})]})]});return i?L?e.jsx(G,{children:e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-background flex flex-col","data-testid":"pagefind-search-mobile",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 h-14 border-b border-border bg-card flex-shrink-0 pt-safe",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Search"}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 hover:bg-muted rounded-full","data-testid":"search-close-btn",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-border bg-card flex-shrink-0",children:[m?e.jsx(B,{className:"w-5 h-5 text-muted-foreground animate-spin flex-shrink-0"}):e.jsx(k,{className:"w-5 h-5 text-muted-foreground flex-shrink-0"}),e.jsx("input",{ref:C,type:"text",value:l,onChange:a=>c(a.target.value),onKeyDown:z,placeholder:m?"Loading search...":"Search questions...",className:"flex-1 bg-transparent text-foreground text-base outline-none placeholder:text-muted-foreground/50",autoComplete:"off",spellCheck:!1,disabled:m,"data-testid":"search-input"}),l&&e.jsx("button",{onClick:()=>c(""),className:"p-1.5 hover:bg-muted rounded-full flex-shrink-0",children:e.jsx(D,{className:"w-4 h-4 text-muted-foreground"})})]}),b&&e.jsx("div",{className:"px-4 py-2 bg-yellow-500/10 border-b border-yellow-500/20 text-yellow-600 dark:text-yellow-400 text-xs flex-shrink-0",children:b}),s(),R(),e.jsx("div",{className:"px-4 py-3 border-t border-border bg-card flex-shrink-0",style:{paddingBottom:"max(env(safe-area-inset-bottom), 12px)"},children:e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:n.length>0?`${n.length} result${n.length!==1?"s":""}`:"Tap to search"})})]})}):e.jsx(G,{children:e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-background/80 backdrop-blur-sm flex items-start justify-center pt-[10vh] px-4",onClick:x,"data-testid":"pagefind-search-desktop",children:e.jsxs(A.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:"w-full max-w-2xl bg-card border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-border",children:[m?e.jsx(B,{className:"w-5 h-5 text-muted-foreground animate-spin"}):e.jsx(k,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("input",{ref:C,type:"text",value:l,onChange:a=>c(a.target.value),onKeyDown:z,placeholder:m?"Loading search...":"Search questions, topics, tags...",className:"flex-1 bg-transparent text-foreground text-lg outline-none placeholder:text-muted-foreground/50",autoComplete:"off",spellCheck:!1,disabled:m,"data-testid":"search-input"}),l&&e.jsx("button",{onClick:()=>c(""),className:"p-1.5 hover:bg-muted rounded-full",children:e.jsx(D,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("kbd",{className:"px-2 py-1 text-[10px] text-muted-foreground bg-muted border border-border rounded",children:"ESC"})]}),b&&e.jsx("div",{className:"px-4 py-2 bg-yellow-500/10 border-b border-yellow-500/20 text-yellow-600 dark:text-yellow-400 text-xs",children:b}),s(),R(),e.jsxs("div",{className:"px-4 py-3 border-t border-border flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"↑↓"})," Navigate"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"↵"})," Select"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"ESC"})," Close"]})]}),n.length>0&&e.jsxs("span",{children:[n.length," result",n.length!==1?"s":""]})]})]})})}):null}const se="search-provider";function Ne(){const[i,x]=d.useState(()=>typeof window>"u"?"fuzzy":localStorage.getItem(se)||"fuzzy"),[l,c]=d.useState(!1);return d.useEffect(()=>{async function r(){try{const p=await fetch("/pagefind/pagefind.js",{method:"HEAD"});c(p.ok)}catch{c(!1)}}r()},[]),{provider:i==="pagefind"&&!l?"fuzzy":i,setProvider:r=>{x(r),localStorage.setItem(se,r)},pagefindAvailable:l}}function $e({isOpen:i,onClose:x}){const{provider:l}=Ne();return l==="pagefind"?e.jsx(we,{isOpen:i,onClose:x}):e.jsx(je,{isOpen:i,onClose:x})}export{oe as F,k as S,$e as U,te as V};
