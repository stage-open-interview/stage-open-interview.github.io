import{e as q,u as H,r as d,j as e,m as C,Z as M,H as W,A as X,X as Y,f as _,T as J,h as $}from"./index-D0xwtbAr.js";import{S as K}from"./SEOHead-ntbT5BRP.js";import{D as U}from"./DesktopSidebarWrapper-Bqosq_EG.js";import{G as o,a as A}from"./GenZButton-DzgBVcEA.js";import{g as V,a as ee,b as P,c as se,d as te,e as ae,s as le}from"./tests-DRPiStcq.js";import{C as E}from"./check-D3NRcCye.js";import{A as ie}from"./UnifiedSearch-D9XA5TIn.js";import{C as ne}from"./circle-x-qt5Fu0lu.js";import"./UnifiedNav-B6YtB1Or.js";import"./use-unified-toast-5BD6N9MA.js";import"./chart-column-7wXXrjUn.js";import"./tag-CnKEepch.js";import"./user-C6DleTxx.js";function we(){const{channelId:h}=q(),[ce,j]=H(),[a,I]=d.useState(null),[b,N]=d.useState("loading"),[n,O]=d.useState([]),[l,u]=d.useState(0),[c,g]=d.useState({}),[z,D]=d.useState(0),[r,S]=d.useState(null),[f,w]=d.useState(null);d.useEffect(()=>{h&&V(h).then(t=>{t?(I(t),N("ready")):N("loading")})},[h]);const s=n[l],v=ee(a?.id||""),G=a?P(a.channelId):P("default"),Q=a&&v?se(a,v):!1,k=d.useCallback(()=>{if(!a)return;const t=te(a,15);O(t),g({}),u(0),D(Date.now()),S(null),N("in-progress")},[a]),R=t=>{if(!s)return;const i=c[s.id]||[];if(s.type==="single"){const x={...c,[s.id]:[t]};g(x);const y=s.options.find(m=>m.isCorrect)?.id===t;w(y?"correct":"incorrect"),setTimeout(()=>{w(null),l<n.length-1&&u(l+1)},600)}else i.includes(t)?g({...c,[s.id]:i.filter(x=>x!==t)}):g({...c,[s.id]:[...i,t]})},T=()=>{if(!s||s.type!=="multiple")return;const t=c[s.id]||[];if(t.length===0)return;const i=s.options.filter(m=>m.isCorrect).map(m=>m.id),x=i.every(m=>t.includes(m)),p=t.every(m=>i.includes(m));w(x&&p?"correct":"incorrect"),setTimeout(()=>{w(null),l<n.length-1&&u(l+1)},800)},Z=()=>{l<n.length-1&&u(l+1)},B=()=>{l>0&&u(l-1)},F=()=>{if(!a)return;const t=ae({...a,questions:n},c);S(t);const i={testId:a.id,startedAt:new Date(z).toISOString(),completedAt:new Date().toISOString(),answers:c,score:t.score,passed:t.passed};le(a.id,a.channelId,i,a.version),N("review"),t.passed?$.celebrate():$.disappointed()},L=Object.keys(c).length;return b==="loading"||!a?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#00ff88] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-[#a0a0a0]",children:a?"Loading test...":"No test available for this channel yet"}),e.jsx(o,{onClick:()=>j("/"),className:"mt-4",children:"Go back home"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(K,{title:`${a.title} | Code Reels`,description:a.description,canonical:`https://open-interview.github.io/test/${h}`}),e.jsx(U,{children:e.jsxs("div",{className:"min-h-screen bg-black text-white",children:[b==="ready"&&e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-md w-full",children:e.jsxs(A,{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-[#00ff88] to-[#00d4ff] flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-3xl",children:G.icon})}),e.jsx("h1",{className:"text-xl font-bold mb-2 text-white",children:a.title}),e.jsx("p",{className:"text-sm text-[#a0a0a0]",children:a.description})]}),e.jsxs("div",{className:"space-y-3 mb-6 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 rounded bg-white/5",children:[e.jsx("span",{className:"text-[#a0a0a0]",children:"Questions"}),e.jsxs("span",{className:"font-bold",children:["15 (random from ",a.questions.length,")"]})]}),e.jsxs("div",{className:"flex justify-between p-2 rounded bg-white/5",children:[e.jsx("span",{className:"text-[#a0a0a0]",children:"Passing Score"}),e.jsxs("span",{className:"font-bold",children:[a.passingScore,"%"]})]}),v&&!Q&&e.jsxs("div",{className:"flex justify-between p-2 bg-[#00ff88]/10 rounded border border-[#00ff88]/30",children:[e.jsx("span",{className:"text-[#a0a0a0]",children:"Your Best"}),e.jsxs("span",{className:"font-bold text-[#00ff88]",children:[v.bestScore,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{onClick:k,className:"w-full",children:[e.jsx(M,{className:"w-5 h-5 mr-2"})," Start Test"]}),e.jsx(o,{variant:"secondary",onClick:()=>j(`/channel/${h}`),className:"w-full",children:"Back to Channel"})]})]})})}),b==="in-progress"&&s&&e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("header",{className:"border-b border-white/10 p-2.5 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j("/"),className:"flex items-center gap-1 px-2 py-1 text-xs text-[#a0a0a0] hover:text-white transition-colors",children:e.jsx(W,{className:"w-3.5 h-3.5"})}),e.jsxs("span",{className:"text-xs text-[#a0a0a0]",children:[l+1,"/",n.length]}),e.jsx("div",{className:"h-1 w-20 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#00ff88] transition-all",style:{width:`${(l+1)/n.length*100}%`}})})]}),e.jsxs("span",{className:"text-xs text-[#a0a0a0]",children:[L,"/",n.length]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(X,{mode:"wait",children:e.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:`px-2 py-0.5 text-[10px] uppercase rounded ${s.type==="multiple"?"bg-[#ff0080]/20 text-[#ff0080]":"bg-[#00d4ff]/20 text-[#00d4ff]"}`,children:s.type==="multiple"?"Select all that apply":"Single choice"}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] uppercase rounded ${s.difficulty==="beginner"?"bg-[#00ff88]/20 text-[#00ff88]":s.difficulty==="intermediate"?"bg-[#ffd700]/20 text-[#ffd700]":"bg-[#ff0080]/20 text-[#ff0080]"}`,children:s.difficulty})]}),e.jsx("h2",{className:"text-lg font-bold mb-6",children:s.question}),e.jsx("div",{className:"space-y-2",children:s.options.map(t=>{const i=(c[s.id]||[]).includes(t.id),x=f&&t.isCorrect,p=f==="incorrect"&&i&&!t.isCorrect,y=s.type==="multiple";return e.jsx("button",{onClick:()=>R(t.id),disabled:f!==null,className:`w-full p-4 text-left border rounded-lg transition-all ${x?"border-[#00ff88] bg-[#00ff88]/20":p?"border-[#ff0080] bg-[#ff0080]/20":i?"border-[#00ff88] bg-[#00ff88]/10":"border-white/10 hover:border-[#00ff88]/50"} ${f?"cursor-default":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`w-6 h-6 ${y?"rounded-md":"rounded-full"} border-2 flex items-center justify-center flex-shrink-0 ${x?"border-[#00ff88] bg-[#00ff88]":p?"border-[#ff0080] bg-[#ff0080]":i?"border-[#00ff88] bg-[#00ff88]":"border-white/30"}`,children:[x&&e.jsx(E,{className:"w-4 h-4 text-black"}),p&&e.jsx(Y,{className:"w-4 h-4 text-white"}),!f&&i&&e.jsx(E,{className:"w-4 h-4 text-black"})]}),e.jsx("span",{className:"text-sm",children:t.text})]})},t.id)})}),s.type==="multiple"&&!f&&e.jsx("p",{className:"mt-3 text-xs text-[#a0a0a0] text-center",children:'Select all correct answers, then click "Confirm" to continue'})]},s.id)})})}),e.jsx("footer",{className:"border-t border-white/10 p-2",children:e.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between gap-2",children:[e.jsxs(o,{size:"sm",variant:"secondary",onClick:B,disabled:l===0,children:[e.jsx(_,{className:"w-3.5 h-3.5 mr-1"}),"Prev"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[#a0a0a0]",children:[e.jsx("span",{className:"font-medium text-white",children:l+1}),e.jsx("span",{children:"/"}),e.jsx("span",{children:n.length})]}),l===n.length-1?s?.type==="multiple"?e.jsx(o,{size:"sm",onClick:T,disabled:(c[s.id]||[]).length===0||f!==null,children:"Submit"}):e.jsx(o,{size:"sm",onClick:F,children:"Submit"}):s?.type==="multiple"?e.jsx(o,{size:"sm",onClick:T,disabled:(c[s.id]||[]).length===0||f!==null,children:"Confirm"}):e.jsxs(o,{size:"sm",variant:"secondary",onClick:Z,disabled:l>=n.length-1,children:["Next",e.jsx(ie,{className:"w-3.5 h-3.5 ml-1"})]})]})})]}),b==="review"&&r&&e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-md w-full",children:e.jsx(A,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-24 h-24 rounded-2xl flex items-center justify-center mx-auto mb-6 ${r.passed?"bg-[#00ff88]/20":"bg-[#ff0080]/20"}`,children:r.passed?e.jsx(J,{className:"w-12 h-12 text-[#00ff88]"}):e.jsx(ne,{className:"w-12 h-12 text-[#ff0080]"})}),e.jsxs("div",{className:"text-6xl font-black text-white mb-2",children:[r.score,"%"]}),e.jsx("p",{className:`text-xl font-semibold mb-8 ${r.passed?"text-[#00ff88]":"text-[#ff0080]"}`,children:r.passed?"Passed!":"Not Passed"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-black/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-[#00ff88]",children:r.correct}),e.jsx("div",{className:"text-xs text-[#a0a0a0]",children:"Correct"})]}),e.jsxs("div",{className:"bg-black/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-[#ff0080]",children:r.total-r.correct}),e.jsx("div",{className:"text-xs text-[#a0a0a0]",children:"Incorrect"})]})]}),e.jsxs("div",{className:"space-y-2",children:[!r.passed&&e.jsx(o,{onClick:k,className:"w-full",children:"Try Again"}),e.jsx(o,{variant:"secondary",onClick:()=>j(`/channel/${h}`),className:"w-full",children:"Back to Channel"})]})]})})})})]})})]})}export{we as default};
