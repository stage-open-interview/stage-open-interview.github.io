import{r as n,z as g,f as S}from"./index-BS2HGL4O.js";const l="user-preferences",o={role:null,subscribedChannels:[],onboardingComplete:!1,createdAt:new Date().toISOString()};function p(){const[r,t]=n.useState(()=>{if(typeof window>"u")return o;try{const e=localStorage.getItem(l);if(e)return JSON.parse(e)}catch(e){console.error("Failed to load preferences:",e)}return o});n.useEffect(()=>{try{localStorage.setItem(l,JSON.stringify(r))}catch(e){console.error("Failed to save preferences:",e)}},[r]);const b=n.useCallback(e=>{const a=g(e).map(c=>c.id);t(c=>({...c,role:e,subscribedChannels:a,onboardingComplete:!0}))},[]),u=n.useCallback(e=>{t(s=>s.subscribedChannels.includes(e)?s:{...s,subscribedChannels:[...s.subscribedChannels,e]})},[]),i=n.useCallback(e=>{t(s=>({...s,subscribedChannels:s.subscribedChannels.filter(a=>a!==e)}))},[]),d=n.useCallback(e=>{t(s=>s.subscribedChannels.includes(e)?{...s,subscribedChannels:s.subscribedChannels.filter(a=>a!==e)}:{...s,subscribedChannels:[...s.subscribedChannels,e]})},[]),C=n.useCallback(e=>r.subscribedChannels.includes(e),[r.subscribedChannels]),f=n.useCallback(()=>S.filter(e=>r.subscribedChannels.includes(e.id)),[r.subscribedChannels]),h=n.useCallback(()=>{t(o),localStorage.removeItem(l)},[]),m=n.useCallback(()=>{const e=["system-design","algorithms","frontend","backend","database","devops"];t(s=>({...s,subscribedChannels:e,onboardingComplete:!0}))},[]);return{preferences:r,setRole:b,subscribeChannel:u,unsubscribeChannel:i,toggleSubscription:d,isSubscribed:C,getSubscribedChannels:f,resetPreferences:h,skipOnboarding:m,needsOnboarding:!r.onboardingComplete}}export{p as u};
