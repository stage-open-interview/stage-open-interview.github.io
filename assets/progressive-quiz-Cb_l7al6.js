function A(e,n,t){if(e.length===0)return null;const r=n.performanceHistory.slice(-3),c=r.length>0?r.filter(Boolean).length/r.length:.5,u=w(n.difficultyLevel,c,n.totalAnswered),l=[];if(e.forEach(i=>{i.questions.forEach(s=>{n.questions.some(a=>a.id===s.id)||l.push({question:s,test:i,relevanceScore:0})})}),l.length===0)return null;t&&l.forEach(i=>{i.relevanceScore=v(t,i.question)});const f=l.filter(i=>i.question.difficulty===u),o=f.length>0?f:l;if(t){const i=o.sort((s,a)=>a.relevanceScore-s.relevanceScore).slice(0,5);return i[Math.floor(Math.random()*i.length)]}else return o[Math.floor(Math.random()*o.length)]}function w(e,n,t){return t<2?"beginner":n>.7?e==="beginner"?"intermediate":"advanced":n<.4?e==="advanced"?"intermediate":"beginner":e}function v(e,n){let t=0;e.difficulty===n.difficulty&&(t+=.2);const r=m(e.question),c=m(n.question),l=r.filter(o=>c.includes(o)).length/Math.max(r.length,c.length);t+=l*.5;const f=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=f*.3,Math.min(t,1)}function k(e,n){let t=0;e.difficulty&&n.difficulty&&e.difficulty===n.difficulty&&(t+=.2);const r=m(e.question),c=m(n.question),l=r.filter(o=>c.includes(o)).length/Math.max(r.length,c.length,1);t+=l*.5;const f=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=f*.3,Math.min(t,1)}function m(e){const n=new Set(["what","how","why","when","where","which","who","the","a","an","and","or","but","in","on","at","to","for","of","with","by","from","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","should","could","can","may","might","must","shall"]);return e.toLowerCase().replace(/[^a-z0-9\s-]/g," ").split(/\s+/).filter(t=>t.length>3&&!n.has(t)).slice(0,10)}function H(){return{questions:[],currentIndex:0,correctCount:0,totalAnswered:0,difficultyLevel:"beginner",performanceHistory:[]}}function Q(e,n,t){return{...e,questions:[...e.questions,n],currentIndex:e.currentIndex+1,correctCount:e.correctCount+(t?1:0),totalAnswered:e.totalAnswered+1,performanceHistory:[...e.performanceHistory,t],difficultyLevel:w(e.difficultyLevel,[...e.performanceHistory,t].slice(-3).filter(Boolean).length/Math.min([...e.performanceHistory,t].length,3),e.totalAnswered+1)}}function K(e,n=20){const t=Math.min(n,e.length);if(t===0)return[];const r=[],c=new Set;let u="beginner",l=[];const f=()=>e.filter(o=>!c.has(o.id));for(let o=0;o<t;o++){const i=f();if(i.length===0)break;let s;if(o===0){const a=i.filter(d=>!d.difficulty||d.difficulty==="beginner"||d.difficulty==="intermediate"),g=a.length>0?a:i;s=g[Math.floor(Math.random()*g.length)]}else{const a=l.slice(-3),g=a.length>0?a.filter(Boolean).length/a.length:.5,d=w(u,g,o);u=d;const M=i.filter(h=>h.difficulty===d),b=M.length>0?M:i,S=r[o-1],y=b.map(h=>({question:h,score:k(S,h)}));y.sort((h,x)=>x.score-h.score);const p=y.slice(0,Math.min(5,y.length));s=p[Math.floor(Math.random()*p.length)].question}r.push(s),c.add(s.id),l.push(Math.random()>.4)}return r}export{K as g,H as i,A as s,Q as u};
