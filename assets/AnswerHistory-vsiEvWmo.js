import{r as l,a as S,j as e,m as x,C as D,S as q}from"./index-Bd4OfHjt.js";import{S as A}from"./SEOHead-DMy2H_zX.js";import{D as L}from"./DesktopSidebarWrapper-BeevHAYG.js";import{H as C}from"./history-DUsbZf-4.js";import{C as T}from"./chart-column-8tMXumHP.js";import{T as O}from"./trending-up-BFZ7gUhe.js";import{C as $}from"./calendar-DO6NJQZI.js";import{D as E}from"./download-CYrisO8C.js";import{C as R}from"./clock-DxtfVdFZ.js";import"./UnifiedNav-BhtY2tpG.js";import"./book-open-C2d09uNf.js";import"./target-DhIvVmUJ.js";import"./mic-CdTPNIKc.js";import"./use-unified-toast-CTLjDvXk.js";import"./tag-Dn0a4MoH.js";import"./bookmark-BGMfdiyv.js";import"./user-CyQS8Ggn.js";import"./UnifiedSearch-ClhsMaBY.js";import"./arrow-right-CW9QK2F-.js";import"./loader-circle-BLr-gu0E.js";function oe(){const[r,d]=l.useState([]),[m,h]=l.useState(!0),[i,u]=l.useState(""),[c,f]=l.useState("all"),[g,k]=l.useState("all");l.useEffect(()=>{(()=>{const s=[];Object.keys(localStorage).forEach(a=>{if(a.startsWith("history-")){const o=a.replace("history-",""),b=S.find(n=>n.id===o)?.name||o;try{const n=localStorage.getItem(a);n&&JSON.parse(n).forEach(p=>{s.push({questionId:p.questionId,channelId:o,channelName:b,timestamp:p.timestamp,date:new Date(p.timestamp).toISOString().split("T")[0]})})}catch(n){console.error(`Failed to parse history for ${o}:`,n)}}}),s.sort((a,o)=>o.timestamp-a.timestamp),d(s),h(!1)})()},[]);const v=l.useMemo(()=>{let t=r;if(c!=="all"&&(t=t.filter(s=>s.channelId===c)),g!=="all"){const s=Date.now(),a={today:s-1440*60*1e3,week:s-10080*60*1e3,month:s-720*60*60*1e3}[g];t=t.filter(o=>o.timestamp>=a)}if(i){const s=i.toLowerCase();t=t.filter(a=>a.questionId.toLowerCase().includes(s)||a.channelName.toLowerCase().includes(s))}return t},[r,c,g,i]),y=l.useMemo(()=>{const t=r.length,s=new Set(r.map(n=>n.channelId)).size,o=r.filter(n=>n.timestamp>=Date.now()-10080*60*1e3).length/7,N=Array.from(new Set(r.map(n=>n.date))).sort().reverse();let b=0;new Date().toISOString().split("T")[0];for(let n=0;n<N.length;n++){const j=new Date;j.setDate(j.getDate()-n);const p=j.toISOString().split("T")[0];if(N[n]===p)b++;else break}return{totalAnswered:t,channelsUsed:s,questionsPerDay:o.toFixed(1),currentStreak:b}},[r]),I=()=>{const t=JSON.stringify(r,null,2),s=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`answer-history-${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(a)},H=l.useMemo(()=>Array.from(new Set(r.map(s=>s.channelId))).map(s=>{const a=S.find(o=>o.id===s);return{id:s,name:a?.name||s,count:r.filter(o=>o.channelId===s).length}}).sort((s,a)=>a.count-s.count),[r]);return e.jsxs(L,{children:[e.jsx(A,{title:"Answer History - CodeReels",description:"View your complete question answering history across all channels"}),e.jsx("div",{className:"min-h-screen bg-background pb-20 lg:pb-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Answer History"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your learning journey"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(w,{icon:e.jsx(D,{className:"w-5 h-5"}),label:"Total Answered",value:y.totalAnswered,color:"text-green-500",bgColor:"bg-green-500/10"}),e.jsx(w,{icon:e.jsx(T,{className:"w-5 h-5"}),label:"Channels Used",value:y.channelsUsed,color:"text-blue-500",bgColor:"bg-blue-500/10"}),e.jsx(w,{icon:e.jsx(O,{className:"w-5 h-5"}),label:"Per Day (7d avg)",value:y.questionsPerDay,color:"text-purple-500",bgColor:"bg-purple-500/10"}),e.jsx(w,{icon:e.jsx($,{className:"w-5 h-5"}),label:"Current Streak",value:`${y.currentStreak} days`,color:"text-amber-500",bgColor:"bg-amber-500/10"})]}),e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-card border border-border rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search by question ID or channel...",value:i,onChange:t=>u(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})}),e.jsxs("select",{value:c,onChange:t=>f(t.target.value),className:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsxs("option",{value:"all",children:["All Channels (",r.length,")"]}),H.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.count,")"]},t.id))]}),e.jsxs("select",{value:g,onChange:t=>k(t.target.value),className:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"})]}),e.jsxs("button",{onClick:I,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Export"]})]})}),m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):v.length===0?e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(C,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No History Found"}),e.jsx("p",{className:"text-muted-foreground",children:r.length===0?"Start answering questions to build your history!":"Try adjusting your filters to see more results."})]}):e.jsx("div",{className:"space-y-2",children:v.map((t,s)=>e.jsx(U,{entry:t,index:s},`${t.questionId}-${t.timestamp}`))})]})})]})}function w({icon:r,label:d,value:m,color:h,bgColor:i}){return e.jsxs(x.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-card border border-border rounded-xl p-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${i} ${h} flex items-center justify-center mb-3`,children:r}),e.jsx("div",{className:"text-2xl font-bold mb-1",children:m}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d})]})}function U({entry:r,index:d}){const m=l.useMemo(()=>{const i=Date.now()-r.timestamp,u=Math.floor(i/6e4),c=Math.floor(i/36e5),f=Math.floor(i/864e5);return u<1?"just now":u<60?`${u}m ago`:c<24?`${c}h ago`:f<7?`${f}d ago`:new Date(r.timestamp).toLocaleDateString()},[r.timestamp]);return e.jsx(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:d*.02},className:"bg-card border border-border rounded-lg p-4 hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(D,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm truncate",children:r.questionId}),e.jsx("div",{className:"text-xs text-muted-foreground",children:r.channelName})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground flex-shrink-0",children:[e.jsx(R,{className:"w-3.5 h-3.5"}),m]})]})})}export{oe as default};
