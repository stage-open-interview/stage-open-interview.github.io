import{u as X,k as _,r as t,j as e,f as ee,A as te,m as W,l as se}from"./index-DOYVIj8F.js";import{S as re}from"./SEOHead-DotXq0Bw.js";import{A as ne}from"./AppLayout-DNSIdfbr.js";import{G as v,a as q}from"./GenZButton-DMUHdj4b.js";import{G as B,a as ie}from"./GenZMicrophone-BIS8uXyH.js";import{B as ae,C as oe}from"./use-unified-toast-XNmZYGPi.js";import{E as ce}from"./eye-off-CcSqLI6i.js";import{E as M}from"./eye-DmRKGRk3.js";import{S as le}from"./sparkles-D8ZWFGtq.js";import{R as de}from"./rotate-ccw-D065JP11.js";import"./tag-DX-SISCc.js";import"./UnifiedSearch-97FBXn4U.js";import"./UnifiedNav-CzXdSTi6.js";import"./chart-column-C1CqMQaX.js";import"./user-DzrWyxRh.js";const Z=typeof window<"u"&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window);function k(l){return l.trim().split(/\s+/).filter(h=>h.length>0).length}function ue(l,h,s){const j=k(l),c=k(h);let d;const o=j/c;return o>=.8&&o<=1.2?d="Great job! Your answer length is perfect! ðŸŒŸ":o>=.5?d="Good effort! Try to cover more details. ðŸ’ª":j>0?d="Keep practicing! Try to elaborate more. ðŸ“š":d="Start speaking to practice! ðŸŽ¤",{wordsSpoken:j,targetWords:c,duration:s,message:d}}function Ce(){const[,l]=X(),{getSubscribedChannels:h}=_(),[s,j]=t.useState("interview"),[c,d]=t.useState([]),[o,D]=t.useState(0),[V,R]=t.useState(!0),[u,C]=t.useState("idle"),[p,A]=t.useState(""),[T,E]=t.useState(""),[F,G]=t.useState(0),[w,I]=t.useState(null),[O,y]=t.useState(!1),N=t.useRef(null),g=t.useRef(null),P=t.useRef(0),L=t.useRef("idle"),[z,H]=t.useState(!1),i=c[o],Q=i?.answer?k(i.answer):0;t.useEffect(()=>{L.current=u},[u]),t.useEffect(()=>{async function r(){R(!0);const a=h();if(a.length===0){R(!1);return}try{const n=[];for(const m of a)try{const x=(await se.getData(m.id)).questions.filter(f=>f.voiceSuitable!==!1&&f.answer&&f.answer.length>100);n.push(...x)}catch(b){console.error(`Failed to load ${m.id}`,b)}if(n.length>0){const m=n.sort(()=>Math.random()-.5);d(m.slice(0,15))}}catch(n){console.error("Failed to load questions",n)}R(!1)}r()},[h]),t.useEffect(()=>{if(!Z)return;const r=window.SpeechRecognition||window.webkitSpeechRecognition,a=new r;return a.continuous=!0,a.interimResults=!0,a.lang="en-US",a.onresult=n=>{let m="",b="";for(let x=n.resultIndex;x<n.results.length;x++){const f=n.results[x];f.isFinal?b+=f[0].transcript+" ":m+=f[0].transcript}b&&A(x=>(x+b).trim()),E(m)},a.onerror=n=>{console.error("Speech recognition error:",n.error)},a.onend=()=>{if(L.current==="recording")try{a.start()}catch{}},N.current=a,H(!0),()=>{try{a.stop()}catch{}}},[]),t.useEffect(()=>(u==="recording"?g.current=setInterval(()=>{G(Math.floor((Date.now()-P.current)/1e3))},1e3):g.current&&(clearInterval(g.current),g.current=null),()=>{g.current&&clearInterval(g.current)}),[u]);const U=t.useCallback(()=>{if(N.current){A(""),E(""),I(null),G(0),P.current=Date.now();try{N.current.start(),C("recording")}catch(r){console.error("Failed to start recording:",r)}}},[]),$=t.useCallback(()=>{if(N.current){try{N.current.stop()}catch{}if(C("recorded"),i){const r=ue(p,i.answer,F);I(r),s==="interview"&&y(!0)}}},[p,i,F,s]),S=t.useCallback(()=>{A(""),E(""),I(null),G(0),C("idle"),y(s==="training")},[s]),K=t.useCallback(()=>{o<c.length-1?(D(r=>r+1),S()):l("/")},[o,c.length,S,l]),Y=t.useCallback(()=>{S()},[S]),J=t.useCallback(()=>{const r=s==="training"?"interview":"training";j(r),y(r==="training")},[s]);return t.useEffect(()=>{y(s==="training")},[s,o]),V?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[#00ff88]/20 flex items-center justify-center mx-auto mb-4",children:e.jsx("div",{className:"w-8 h-8 border-3 border-primary border-t-transparent rounded-full animate-spin"})}),e.jsx("p",{className:"text-muted-foreground",children:"Loading questions..."})]})}):c.length===0?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-muted/50 flex items-center justify-center mx-auto mb-6",children:e.jsx(ae,{className:"w-10 h-10 text-muted-foreground"})}),e.jsx("h2",{className:"text-xl font-bold text-foreground mb-2",children:"No Questions Available"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Subscribe to channels to access practice questions"}),e.jsx(v,{onClick:()=>l("/channels"),children:"Browse Channels"})]})}):Z?((o+1)/c.length*100,e.jsxs(e.Fragment,{children:[e.jsx(re,{title:"Voice Practice | Code Reels",description:"Practice answering interview questions with voice recording and feedback",canonical:"https://open-interview.github.io/voice-practice"}),e.jsx(ne,{fullWidth:!0,hideNav:!0,children:e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsxs("header",{className:"sticky top-0 z-50 border-b border-border bg-background/95 backdrop-blur-md",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 h-14 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>l("/"),className:"p-1.5 hover:bg-muted rounded-lg transition-colors",children:e.jsx(ee,{className:"w-4 h-4 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-foreground text-sm",children:"Voice Practice"}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Q",o+1,"/",c.length]})]})]}),e.jsxs(v,{variant:s==="interview"?"primary":"secondary",size:"sm",onClick:J,children:[s==="interview"?e.jsx(ce,{className:"w-3.5 h-3.5 mr-1"}):e.jsx(M,{className:"w-3.5 h-3.5 mr-1"}),s==="interview"?"Interview":"Training"]})]}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 pb-2",children:e.jsx(B,{value:o+1,max:c.length,color:"green"})})]}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 py-6",children:e.jsx(te,{mode:"wait",children:e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[e.jsxs(q,{className:"p-6",neonBorder:!0,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-[#00ff88]/10 flex-shrink-0",children:e.jsx(le,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-2",children:i.question}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium ${i.difficulty==="beginner"?"bg-[#00ff88]/20 text-primary":i.difficulty==="intermediate"?"bg-[#ffd700]/20 text-[#ffd700]":"bg-[#ff0080]/20 text-[#ff0080]"}`,children:i.difficulty}),e.jsx("span",{className:"text-muted-foreground",children:"â€¢"}),e.jsx("span",{className:"text-muted-foreground",children:i.channel})]})]})]}),O&&e.jsxs("div",{className:"bg-background/50 rounded-xl p-5 border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:s==="training"?"Answer to Read":"Ideal Answer"})]}),e.jsxs("span",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted/50 rounded-lg",children:[Q," words"]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx("p",{className:"text-foreground text-[15px] leading-[1.7] whitespace-pre-wrap",children:i.answer})})]})]}),e.jsx(q,{className:"p-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx(ie,{isRecording:u==="recording",onStart:U,onStop:$,disabled:!z}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"bg-background/50 rounded-xl p-4 min-h-[100px] border border-border",children:p||T?e.jsxs("p",{className:"text-foreground text-sm whitespace-pre-wrap",children:[p,e.jsx("span",{className:"text-muted-foreground",children:T})]}):e.jsx("p",{className:"text-muted-foreground text-sm italic",children:u==="recording"?"Listening... Start speaking":"Click the microphone to start"})}),p&&e.jsx("div",{className:"mt-3",children:e.jsx(B,{value:k(p),max:Q,color:"blue",showLabel:!0})})]}),w&&e.jsxs(W.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full bg-[#00ff88]/10 border border-primary/30 rounded-xl p-4",children:[e.jsx("p",{className:"text-primary font-semibold mb-2",children:w.message}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Words: ",w.wordsSpoken,"/",w.targetWords]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Time: ",w.duration,"s"]})]})]}),e.jsx("div",{className:"flex gap-3",children:u==="recorded"&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{variant:"secondary",onClick:Y,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsxs(v,{variant:"primary",onClick:K,children:["Next Question",e.jsx(oe,{className:"w-4 h-4 ml-2"})]})]})})]})})]},i.id)})})]})})]})):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-3",children:"Browser Not Supported"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Voice practice requires the Web Speech API. Please use Chrome, Edge, or Safari."}),e.jsx(v,{onClick:()=>l("/"),children:"Go Home"})]})})}export{Ce as default};
