const b="test-progress";let g=null;async function v(){if(g)return g;try{const e=await fetch("/data/tests.json");return e.ok?(g=await e.json(),g||[]):[]}catch{return[]}}async function R(e){return(await v()).find(t=>t.channelId===e)||null}function m(){try{const e=localStorage.getItem(b);return e?JSON.parse(e):{}}catch{return{}}}function O(e){return m()[e]||null}function $(e,n,t){const s=m();s[e]||(s[e]={testId:e,channelId:n,attempts:[],bestScore:0,passed:!1}),s[e].attempts.push(t),s[e].lastAttemptAt=t.completedAt,t.score!==void 0&&(t.score>s[e].bestScore&&(s[e].bestScore=t.score),t.passed&&(s[e].passed=!0)),localStorage.setItem(b,JSON.stringify(s))}function k(e,n){let t=0;const s=e.questions.length;e.questions.forEach(c=>{const a=n[c.id]||[],o=c.options.filter(i=>i.isCorrect).map(i=>i.id);if(c.type==="single")a.length===1&&o.includes(a[0])&&t++;else{const i=o.every(l=>a.includes(l)),f=a.every(l=>o.includes(l));i&&f&&a.length>0&&t++}});const r=Math.round(t/s*100);return{score:r,correct:t,total:s,passed:r>=e.passingScore}}function x(e){const n=[...e];for(let t=n.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[n[t],n[s]]=[n[s],n[t]]}return n}function A(e,n){let t=0;e.difficulty===n.difficulty&&(t+=.2);const s=S(e.question),r=S(n.question),a=s.filter(i=>r.includes(i)).length/Math.max(s.length,r.length,1);t+=a*.5;const o=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=o*.3,Math.min(t,1)}function S(e){const n=new Set(["what","how","why","when","where","which","who","the","a","an","and","or","but","in","on","at","to","for","of","with","by","from","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","should","could","can","may","might","must","shall"]);return e.toLowerCase().replace(/[^a-z0-9\s-]/g," ").split(/\s+/).filter(t=>t.length>3&&!n.has(t)).slice(0,10)}function Q(e,n,t){return t<2?"beginner":n>.7?e==="beginner"?"intermediate":"advanced":n<.4?e==="advanced"?"intermediate":"beginner":e}function P(e,n=20){const t=Math.min(n,e.questions.length);if(t===0)return[];const s=[],r=[...e.questions];let c="beginner",a=[];for(let o=0;o<t;o++){let i;if(o===0){const l=r.filter(h=>h.difficulty==="beginner"||h.difficulty==="intermediate"),d=l.length>0?l:r;i=d[Math.floor(Math.random()*d.length)]}else{const l=a.slice(-3),d=l.length>0?l.filter(Boolean).length/l.length:.5,h=Q(c,d,o);c=h;const w=r.filter(u=>u.difficulty===h),M=w.length>0?w:r,C=s[o-1],p=M.map(u=>({question:u,score:A(C,u)}));p.sort((u,T)=>T.score-u.score);const y=p.slice(0,Math.min(5,p.length));i=y[Math.floor(Math.random()*y.length)].question}s.push(i);const f=r.indexOf(i);f>-1&&r.splice(f,1),a.push(Math.random()>.4)}return s.map(o=>({...o,options:x(o.options)}))}function j(e,n,t){const r=`${t?"âœ…":"ðŸ“Š"} I scored ${n}% on the ${e} test on Code Reels!`;return`https://twitter.com/intent/tweet?text=${encodeURIComponent(r)}&url=${encodeURIComponent("https://open-interview.github.io/")}`}function E(e,n,t){return`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent("https://open-interview.github.io/")}`}function K(){const e=m(),n=Object.values(e),t=n.length,s=n.filter(o=>o.passed).length,r=n.reduce((o,i)=>o+i.attempts.length,0),c=n.map(o=>o.bestScore).filter(o=>o>0),a=c.length>0?Math.round(c.reduce((o,i)=>o+i,0)/c.length):0;return{totalTests:t,passedTests:s,totalAttempts:r,averageScore:a}}export{P as a,O as b,j as c,E as d,k as e,m as f,R as g,K as h,v as l,$ as s};
