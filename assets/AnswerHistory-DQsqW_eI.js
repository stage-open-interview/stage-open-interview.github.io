import{d as q,r as i,q as S,j as e,m as h,C as D,S as L}from"./index-4gP9q0LG.js";import{S as A}from"./SEOHead-D7_c4On_.js";import{D as T}from"./DesktopSidebarWrapper-CAp2o0c-.js";import{H as C}from"./history-DdYHMJcu.js";import{C as O}from"./chart-column-w1Gl43-T.js";import{T as $}from"./trending-up-D-e1a0x7.js";import{C as M}from"./calendar-DYDmJrTD.js";import{C as E}from"./clock-d5bL_iwt.js";import"./UnifiedNav-B2aXs9hO.js";import"./use-unified-toast-CsB08-AT.js";import"./tag-CqrMsBxs.js";import"./UnifiedSearch-D1W2emq4.js";import"./user-Dpn1OLK3.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],U=q("download",R);function ee(){const[a,d]=i.useState([]),[m,p]=i.useState(!0),[l,u]=i.useState(""),[c,g]=i.useState("all"),[f,k]=i.useState("all");i.useEffect(()=>{(()=>{const s=[];Object.keys(localStorage).forEach(r=>{if(r.startsWith("history-")){const o=r.replace("history-",""),b=S.find(n=>n.id===o)?.name||o;try{const n=localStorage.getItem(r);n&&JSON.parse(n).forEach(x=>{s.push({questionId:x.questionId,channelId:o,channelName:b,timestamp:x.timestamp,date:new Date(x.timestamp).toISOString().split("T")[0]})})}catch(n){console.error(`Failed to parse history for ${o}:`,n)}}}),s.sort((r,o)=>o.timestamp-r.timestamp),d(s),p(!1)})()},[]);const N=i.useMemo(()=>{let t=a;if(c!=="all"&&(t=t.filter(s=>s.channelId===c)),f!=="all"){const s=Date.now(),r={today:s-1440*60*1e3,week:s-10080*60*1e3,month:s-720*60*60*1e3}[f];t=t.filter(o=>o.timestamp>=r)}if(l){const s=l.toLowerCase();t=t.filter(r=>r.questionId.toLowerCase().includes(s)||r.channelName.toLowerCase().includes(s))}return t},[a,c,f,l]),y=i.useMemo(()=>{const t=a.length,s=new Set(a.map(n=>n.channelId)).size,o=a.filter(n=>n.timestamp>=Date.now()-10080*60*1e3).length/7,v=Array.from(new Set(a.map(n=>n.date))).sort().reverse();let b=0;new Date().toISOString().split("T")[0];for(let n=0;n<v.length;n++){const j=new Date;j.setDate(j.getDate()-n);const x=j.toISOString().split("T")[0];if(v[n]===x)b++;else break}return{totalAnswered:t,channelsUsed:s,questionsPerDay:o.toFixed(1),currentStreak:b}},[a]),I=()=>{const t=JSON.stringify(a,null,2),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),o=document.createElement("a");o.href=r,o.download=`answer-history-${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(r)},H=i.useMemo(()=>Array.from(new Set(a.map(s=>s.channelId))).map(s=>{const r=S.find(o=>o.id===s);return{id:s,name:r?.name||s,count:a.filter(o=>o.channelId===s).length}}).sort((s,r)=>r.count-s.count),[a]);return e.jsxs(T,{children:[e.jsx(A,{title:"Answer History - CodeReels",description:"View your complete question answering history across all channels"}),e.jsx("div",{className:"min-h-screen bg-background pb-20 lg:pb-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Answer History"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your learning journey"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(w,{icon:e.jsx(D,{className:"w-5 h-5"}),label:"Total Answered",value:y.totalAnswered,color:"text-green-500",bgColor:"bg-green-500/10"}),e.jsx(w,{icon:e.jsx(O,{className:"w-5 h-5"}),label:"Channels Used",value:y.channelsUsed,color:"text-blue-500",bgColor:"bg-blue-500/10"}),e.jsx(w,{icon:e.jsx($,{className:"w-5 h-5"}),label:"Per Day (7d avg)",value:y.questionsPerDay,color:"text-purple-500",bgColor:"bg-purple-500/10"}),e.jsx(w,{icon:e.jsx(M,{className:"w-5 h-5"}),label:"Current Streak",value:`${y.currentStreak} days`,color:"text-amber-500",bgColor:"bg-amber-500/10"})]}),e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-card border border-border rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search by question ID or channel...",value:l,onChange:t=>u(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})}),e.jsxs("select",{value:c,onChange:t=>g(t.target.value),className:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsxs("option",{value:"all",children:["All Channels (",a.length,")"]}),H.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.count,")"]},t.id))]}),e.jsxs("select",{value:f,onChange:t=>k(t.target.value),className:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"})]}),e.jsxs("button",{onClick:I,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Export"]})]})}),m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):N.length===0?e.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(C,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No History Found"}),e.jsx("p",{className:"text-muted-foreground",children:a.length===0?"Start answering questions to build your history!":"Try adjusting your filters to see more results."})]}):e.jsx("div",{className:"space-y-2",children:N.map((t,s)=>e.jsx(P,{entry:t,index:s},`${t.questionId}-${t.timestamp}`))})]})})]})}function w({icon:a,label:d,value:m,color:p,bgColor:l}){return e.jsxs(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-card border border-border rounded-xl p-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${l} ${p} flex items-center justify-center mb-3`,children:a}),e.jsx("div",{className:"text-2xl font-bold mb-1",children:m}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d})]})}function P({entry:a,index:d}){const m=i.useMemo(()=>{const l=Date.now()-a.timestamp,u=Math.floor(l/6e4),c=Math.floor(l/36e5),g=Math.floor(l/864e5);return u<1?"just now":u<60?`${u}m ago`:c<24?`${c}h ago`:g<7?`${g}d ago`:new Date(a.timestamp).toLocaleDateString()},[a.timestamp]);return e.jsx(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:d*.02},className:"bg-card border border-border rounded-lg p-4 hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(D,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm truncate",children:a.questionId}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.channelName})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground flex-shrink-0",children:[e.jsx(E,{className:"w-3.5 h-3.5"}),m]})]})})}export{ee as default};
