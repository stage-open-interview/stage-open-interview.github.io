const M="test-progress";let p=null;async function A(){if(p)return p;try{const e=await fetch("/data/tests.json");return e.ok?(p=await e.json(),p||[]):[]}catch{return[]}}async function k(e){return(await A()).find(t=>t.channelId===e)||null}function w(){try{const e=localStorage.getItem(M);return e?JSON.parse(e):{}}catch{return{}}}function $(e){return w()[e]||null}function O(e,n,t){const s=w();s[e]||(s[e]={testId:e,channelId:n,attempts:[],bestScore:0,passed:!1}),s[e].attempts.push(t),s[e].lastAttemptAt=t.completedAt,t.score!==void 0&&(t.score>s[e].bestScore&&(s[e].bestScore=t.score),t.passed&&(s[e].passed=!0)),localStorage.setItem(M,JSON.stringify(s))}function P(e,n){let t=0;const s=e.questions.length;e.questions.forEach(c=>{const a=n[c.id]||[],r=c.options.filter(o=>o.isCorrect).map(o=>o.id);if(c.type==="single")a.length===1&&r.includes(a[0])&&t++;else{const o=r.every(l=>a.includes(l)),u=a.every(l=>r.includes(l));o&&u&&a.length>0&&t++}});const i=Math.round(t/s*100);return{score:i,correct:t,total:s,passed:i>=e.passingScore}}function x(e){const n=[...e];for(let t=n.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[n[t],n[s]]=[n[s],n[t]]}return n}function Q(e,n){let t=0;e.difficulty===n.difficulty&&(t+=.2);const s=S(e.question),i=S(n.question),a=s.filter(o=>i.includes(o)).length/Math.max(s.length,i.length,1);t+=a*.5;const r=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=r*.3,Math.min(t,1)}function S(e){const n=new Set(["what","how","why","when","where","which","who","the","a","an","and","or","but","in","on","at","to","for","of","with","by","from","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","should","could","can","may","might","must","shall"]);return e.toLowerCase().replace(/[^a-z0-9\s-]/g," ").split(/\s+/).filter(t=>t.length>3&&!n.has(t)).slice(0,10)}function R(e,n,t){return t<2?"beginner":n>.7?e==="beginner"?"intermediate":"advanced":n<.4?e==="advanced"?"intermediate":"beginner":e}function j(e,n=20){const t=Math.min(n,e.questions.length);if(t===0)return[];const s=[],i=new Set;let c="beginner",a=[];const r=()=>e.questions.filter(o=>!i.has(o.id));for(let o=0;o<t;o++){const u=r();if(u.length===0)break;let l;if(o===0){const h=u.filter(d=>d.difficulty==="beginner"||d.difficulty==="intermediate"),g=h.length>0?h:u;l=g[Math.floor(Math.random()*g.length)]}else{const h=a.slice(-3),g=h.length>0?h.filter(Boolean).length/h.length:.5,d=R(c,g,o);c=d;const y=u.filter(f=>f.difficulty===d),v=y.length>0?y:u,C=s[o-1],m=v.map(f=>({question:f,score:Q(C,f)}));m.sort((f,T)=>T.score-f.score);const b=m.slice(0,Math.min(5,m.length));l=b[Math.floor(Math.random()*b.length)].question}s.push(l),i.add(l.id),a.push(Math.random()>.4)}return s.map(o=>({...o,options:x(o.options)}))}function E(e,n,t){const i=`${t?"âœ…":"ðŸ“Š"} I scored ${n}% on the ${e} test on Code Reels!`;return`https://twitter.com/intent/tweet?text=${encodeURIComponent(i)}&url=${encodeURIComponent("https://open-interview.github.io/")}`}function K(e,n,t){return`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent("https://open-interview.github.io/")}`}function D(){const e=w(),n=Object.values(e),t=n.length,s=n.filter(r=>r.passed).length,i=n.reduce((r,o)=>r+o.attempts.length,0),c=n.map(r=>r.bestScore).filter(r=>r>0),a=c.length>0?Math.round(c.reduce((r,o)=>r+o,0)/c.length):0;return{totalTests:t,passedTests:s,totalAttempts:i,averageScore:a}}export{j as a,$ as b,E as c,K as d,P as e,w as f,k as g,D as h,A as l,O as s};
