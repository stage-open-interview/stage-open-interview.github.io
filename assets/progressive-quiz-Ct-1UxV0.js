function H(e,n,t){if(e.length===0)return null;const o=n.performanceHistory.slice(-3),i=o.length>0?o.filter(Boolean).length/o.length:.5,u=y(n.difficultyLevel,i,n.totalAnswered),c=[];if(e.forEach(r=>{r.questions.forEach(f=>{n.questions.some(s=>s.id===f.id)||c.push({question:f,test:r,relevanceScore:0})})}),c.length===0)return null;t&&c.forEach(r=>{r.relevanceScore=b(t,r.question)});const l=c.filter(r=>r.question.difficulty===u),a=l.length>0?l:c;if(t){const r=a.sort((f,s)=>s.relevanceScore-f.relevanceScore).slice(0,5);return r[Math.floor(Math.random()*r.length)]}else return a[Math.floor(Math.random()*a.length)]}function y(e,n,t){return t<2?"beginner":n>.7?e==="beginner"?"intermediate":"advanced":n<.4?e==="advanced"?"intermediate":"beginner":e}function b(e,n){let t=0;e.difficulty===n.difficulty&&(t+=.2);const o=g(e.question),i=g(n.question),c=o.filter(a=>i.includes(a)).length/Math.max(o.length,i.length);t+=c*.5;const l=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=l*.3,Math.min(t,1)}function v(e,n){let t=0;e.difficulty&&n.difficulty&&e.difficulty===n.difficulty&&(t+=.2);const o=g(e.question),i=g(n.question),c=o.filter(a=>i.includes(a)).length/Math.max(o.length,i.length,1);t+=c*.5;const l=Math.min(e.question.length,n.question.length)/Math.max(e.question.length,n.question.length);return t+=l*.3,Math.min(t,1)}function g(e){const n=new Set(["what","how","why","when","where","which","who","the","a","an","and","or","but","in","on","at","to","for","of","with","by","from","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","should","could","can","may","might","must","shall"]);return e.toLowerCase().replace(/[^a-z0-9\s-]/g," ").split(/\s+/).filter(t=>t.length>3&&!n.has(t)).slice(0,10)}function k(){return{questions:[],currentIndex:0,correctCount:0,totalAnswered:0,difficultyLevel:"beginner",performanceHistory:[]}}function A(e,n,t){return{...e,questions:[...e.questions,n],currentIndex:e.currentIndex+1,correctCount:e.correctCount+(t?1:0),totalAnswered:e.totalAnswered+1,performanceHistory:[...e.performanceHistory,t],difficultyLevel:y(e.difficultyLevel,[...e.performanceHistory,t].slice(-3).filter(Boolean).length/Math.min([...e.performanceHistory,t].length,3),e.totalAnswered+1)}}function Q(e,n=20){const t=Math.min(n,e.length);if(t===0)return[];const o=[],i=[...e];let u="beginner",c=[];for(let l=0;l<t;l++){let a;if(l===0){const f=i.filter(d=>!d.difficulty||d.difficulty==="beginner"||d.difficulty==="intermediate"),s=f.length>0?f:i;a=s[Math.floor(Math.random()*s.length)]}else{const f=c.slice(-3),s=f.length>0?f.filter(Boolean).length/f.length:.5,d=y(u,s,l);u=d;const w=i.filter(h=>h.difficulty===d),p=w.length>0?w:i,x=o[l-1],m=p.map(h=>({question:h,score:v(x,h)}));m.sort((h,S)=>S.score-h.score);const M=m.slice(0,Math.min(5,m.length));a=M[Math.floor(Math.random()*M.length)].question}o.push(a);const r=i.indexOf(a);r>-1&&i.splice(r,1),c.push(Math.random()>.4)}return o}export{Q as g,k as i,H as s,A as u};
