function g(){return"speechSynthesis"in window}let l=!1;const i="tts-voice-preference",p="tts-rate-preference";function b(){return g()?speechSynthesis.getVoices():[]}function f(){try{return localStorage.getItem(i)}catch{return null}}function v(r){try{localStorage.setItem(i,r)}catch{}}function S(){try{const r=localStorage.getItem(p);return r?parseFloat(r):.9}catch{return .9}}function T(r){try{localStorage.setItem(p,String(r))}catch{}}const h="Google UK English Female";function o(){const r=b();if(r.length===0)return null;const e=f();if(e){const t=r.find(u=>u.name===e);if(t)return t}const a=r.find(t=>t.name===h);if(a)return a;const c=r.find(t=>t.name.includes("Google UK English"));if(c)return c;const n=r.find(t=>t.lang==="en-GB");return n||r.find(t=>t.lang.startsWith("en"))||r[0]}function d(r){let e=r;return e=e.replace(/```[\s\S]*?```/g,"... code example omitted ..."),e=e.replace(/`([^`]+)`/g,"$1"),e=e.replace(/\*\*([^*]+)\*\*/g,"$1"),e=e.replace(/\*([^*]+)\*/g,"$1"),e=e.replace(/__([^_]+)__/g,"$1"),e=e.replace(/_([^_]+)_/g,"$1"),e=e.replace(/^#{1,6}\s+/gm,""),e=e.replace(/^[-*â€¢]\s+/gm,"... "),e=e.replace(/^\d+\.\s+/gm,"... "),e=e.replace(/https?:\/\/[^\s]+/g,"link"),e=e.replace(/\[([^\]]+)\]\([^)]+\)/g,"$1"),e=e.replace(/([.!?])\s+/g,"$1 ... "),e=e.replace(/:\s+/g,": ... "),e=e.replace(/;\s+/g,"; ... "),e=e.replace(/\be\.g\./gi,"for example"),e=e.replace(/\bi\.e\./gi,"that is"),e=e.replace(/\betc\./gi,"etcetera"),e=e.replace(/\bvs\./gi,"versus"),e=e.replace(/\bAPI\b/g,"A P I"),e=e.replace(/\bAPIs\b/g,"A P Is"),e=e.replace(/\bURL\b/g,"U R L"),e=e.replace(/\bURLs\b/g,"U R Ls"),e=e.replace(/\bHTML\b/g,"H T M L"),e=e.replace(/\bCSS\b/g,"C S S"),e=e.replace(/\bSQL\b/g,"S Q L"),e=e.replace(/\bJSON\b/g,"Jason"),e=e.replace(/\bREST\b/g,"Rest"),e=e.replace(/\bHTTP\b/g,"H T T P"),e=e.replace(/\bHTTPS\b/g,"H T T P S"),e=e.replace(/\bCPU\b/g,"C P U"),e=e.replace(/\bRAM\b/g,"Ram"),e=e.replace(/\bSSD\b/g,"S S D"),e=e.replace(/\bI\/O\b/g,"I O"),e=e.replace(/\bUI\b/g,"U I"),e=e.replace(/\bUX\b/g,"U X"),e=e.replace(/\bCI\/CD\b/g,"C I C D"),e=e.replace(/\bDevOps\b/gi,"Dev Ops"),e=e.replace(/\bNoSQL\b/gi,"No S Q L"),e=e.replace(/\bGraphQL\b/gi,"Graph Q L"),e=e.replace(/\bORM\b/g,"O R M"),e=e.replace(/\bMVC\b/g,"M V C"),e=e.replace(/\bDOM\b/g,"Dom"),e=e.replace(/\bAWS\b/g,"A W S"),e=e.replace(/\bGCP\b/g,"G C P"),e=e.replace(/\bK8s\b/gi,"Kubernetes"),e=e.replace(/\bk8s\b/gi,"Kubernetes"),e=e.replace(/(\.\.\.\s*){2,}/g,"... "),e=e.replace(/\n{3,}/g,`

`),e=e.trim(),e}function E(r,e={}){if(!g()){e.onError?.("Text-to-speech not supported in this browser");return}m();const a=d(r);if(!a){e.onError?.("No text to speak");return}const c=new SpeechSynthesisUtterance(a),n=o();n&&(c.voice=n),c.rate=e.rate??S(),c.pitch=e.pitch??1.05,c.volume=e.volume??1,c.onstart=()=>{l=!0,e.onStart?.()},c.onend=()=>{l=!1,e.onEnd?.()},c.onerror=s=>{l=!1,e.onError?.(s.error)},b().length===0?speechSynthesis.addEventListener("voiceschanged",()=>{const s=o();s&&(c.voice=s),speechSynthesis.speak(c)},{once:!0}):speechSynthesis.speak(c)}function m(){g()&&(speechSynthesis.cancel(),l=!1)}function I(){return l}export{b as a,f as b,T as c,m as d,E as e,I as f,S as g,g as i,v as s};
