import{u as X,k as _,r as t,j as e,f as ee,A as te,m as W,l as se}from"./index-D0xwtbAr.js";import{S as re}from"./SEOHead-ntbT5BRP.js";import{A as ne}from"./AppLayout-BNgEkDZI.js";import{G as v,a as q}from"./GenZButton-DzgBVcEA.js";import{G as B,a as ae}from"./GenZMicrophone-CmrXi1Xi.js";import{B as ie,C as ce}from"./use-unified-toast-5BD6N9MA.js";import{E as oe}from"./eye-off-DI-orm0R.js";import{E as M}from"./eye-qD2MpJaw.js";import{S as le}from"./sparkles-CvddbY9g.js";import{R as de}from"./rotate-ccw-BzssUQ2Z.js";import"./tag-CnKEepch.js";import"./UnifiedSearch-D9XA5TIn.js";import"./UnifiedNav-B6YtB1Or.js";import"./chart-column-7wXXrjUn.js";import"./user-C6DleTxx.js";const Z=typeof window<"u"&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window);function k(l){return l.trim().split(/\s+/).filter(f=>f.length>0).length}function xe(l,f,s){const j=k(l),o=k(f);let d;const c=j/o;return c>=.8&&c<=1.2?d="Great job! Your answer length is perfect! ðŸŒŸ":c>=.5?d="Good effort! Try to cover more details. ðŸ’ª":j>0?d="Keep practicing! Try to elaborate more. ðŸ“š":d="Start speaking to practice! ðŸŽ¤",{wordsSpoken:j,targetWords:o,duration:s,message:d}}function Ce(){const[,l]=X(),{getSubscribedChannels:f}=_(),[s,j]=t.useState("interview"),[o,d]=t.useState([]),[c,D]=t.useState(0),[V,R]=t.useState(!0),[x,C]=t.useState("idle"),[p,A]=t.useState(""),[T,E]=t.useState(""),[F,G]=t.useState(0),[b,I]=t.useState(null),[O,y]=t.useState(!1),N=t.useRef(null),g=t.useRef(null),P=t.useRef(0),L=t.useRef("idle"),[z,H]=t.useState(!1),a=o[c],Q=a?.answer?k(a.answer):0;t.useEffect(()=>{L.current=x},[x]),t.useEffect(()=>{async function r(){R(!0);const i=f();if(i.length===0){R(!1);return}try{const n=[];for(const m of i)try{const u=(await se.getData(m.id)).questions.filter(h=>h.voiceSuitable!==!1&&h.answer&&h.answer.length>100);n.push(...u)}catch(w){console.error(`Failed to load ${m.id}`,w)}if(n.length>0){const m=n.sort(()=>Math.random()-.5);d(m.slice(0,15))}}catch(n){console.error("Failed to load questions",n)}R(!1)}r()},[f]),t.useEffect(()=>{if(!Z)return;const r=window.SpeechRecognition||window.webkitSpeechRecognition,i=new r;return i.continuous=!0,i.interimResults=!0,i.lang="en-US",i.onresult=n=>{let m="",w="";for(let u=n.resultIndex;u<n.results.length;u++){const h=n.results[u];h.isFinal?w+=h[0].transcript+" ":m+=h[0].transcript}w&&A(u=>(u+w).trim()),E(m)},i.onerror=n=>{console.error("Speech recognition error:",n.error)},i.onend=()=>{if(L.current==="recording")try{i.start()}catch{}},N.current=i,H(!0),()=>{try{i.stop()}catch{}}},[]),t.useEffect(()=>(x==="recording"?g.current=setInterval(()=>{G(Math.floor((Date.now()-P.current)/1e3))},1e3):g.current&&(clearInterval(g.current),g.current=null),()=>{g.current&&clearInterval(g.current)}),[x]);const U=t.useCallback(()=>{if(N.current){A(""),E(""),I(null),G(0),P.current=Date.now();try{N.current.start(),C("recording")}catch(r){console.error("Failed to start recording:",r)}}},[]),$=t.useCallback(()=>{if(N.current){try{N.current.stop()}catch{}if(C("recorded"),a){const r=xe(p,a.answer,F);I(r),s==="interview"&&y(!0)}}},[p,a,F,s]),S=t.useCallback(()=>{A(""),E(""),I(null),G(0),C("idle"),y(s==="training")},[s]),K=t.useCallback(()=>{c<o.length-1?(D(r=>r+1),S()):l("/")},[c,o.length,S,l]),Y=t.useCallback(()=>{S()},[S]),J=t.useCallback(()=>{const r=s==="training"?"interview":"training";j(r),y(r==="training")},[s]);return t.useEffect(()=>{y(s==="training")},[s,c]),V?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[#00ff88]/20 flex items-center justify-center mx-auto mb-4",children:e.jsx("div",{className:"w-8 h-8 border-3 border-[#00ff88] border-t-transparent rounded-full animate-spin"})}),e.jsx("p",{className:"text-[#a0a0a0]",children:"Loading questions..."})]})}):o.length===0?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-white/5 flex items-center justify-center mx-auto mb-6",children:e.jsx(ie,{className:"w-10 h-10 text-[#a0a0a0]"})}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"No Questions Available"}),e.jsx("p",{className:"text-[#a0a0a0] mb-6",children:"Subscribe to channels to access practice questions"}),e.jsx(v,{onClick:()=>l("/channels"),children:"Browse Channels"})]})}):Z?((c+1)/o.length*100,e.jsxs(e.Fragment,{children:[e.jsx(re,{title:"Voice Practice | Code Reels",description:"Practice answering interview questions with voice recording and feedback",canonical:"https://open-interview.github.io/voice-practice"}),e.jsx(ne,{fullWidth:!0,hideNav:!0,children:e.jsxs("div",{className:"min-h-screen bg-black text-white",children:[e.jsxs("header",{className:"sticky top-0 z-50 border-b border-white/10 bg-black/95 backdrop-blur-md",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 h-14 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>l("/"),className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(ee,{className:"w-4 h-4 text-[#a0a0a0]"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-white text-sm",children:"Voice Practice"}),e.jsxs("p",{className:"text-[10px] text-[#a0a0a0]",children:["Q",c+1,"/",o.length]})]})]}),e.jsxs(v,{variant:s==="interview"?"primary":"secondary",size:"sm",onClick:J,children:[s==="interview"?e.jsx(oe,{className:"w-3.5 h-3.5 mr-1"}):e.jsx(M,{className:"w-3.5 h-3.5 mr-1"}),s==="interview"?"Interview":"Training"]})]}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 pb-2",children:e.jsx(B,{value:c+1,max:o.length,color:"green"})})]}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 py-6",children:e.jsx(te,{mode:"wait",children:e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[e.jsxs(q,{className:"p-6",neonBorder:!0,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-[#00ff88]/10 flex-shrink-0",children:e.jsx(le,{className:"w-5 h-5 text-[#00ff88]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-2",children:a.question}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium ${a.difficulty==="beginner"?"bg-[#00ff88]/20 text-[#00ff88]":a.difficulty==="intermediate"?"bg-[#ffd700]/20 text-[#ffd700]":"bg-[#ff0080]/20 text-[#ff0080]"}`,children:a.difficulty}),e.jsx("span",{className:"text-[#a0a0a0]",children:"â€¢"}),e.jsx("span",{className:"text-[#a0a0a0]",children:a.channel})]})]})]}),O&&e.jsxs("div",{className:"bg-black/50 rounded-xl p-5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-[#00ff88]"}),e.jsx("span",{className:"text-sm font-semibold text-white",children:s==="training"?"Answer to Read":"Ideal Answer"})]}),e.jsxs("span",{className:"text-xs text-[#a0a0a0] px-2 py-1 bg-white/5 rounded-lg",children:[Q," words"]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx("p",{className:"text-white text-[15px] leading-[1.7] whitespace-pre-wrap",children:a.answer})})]})]}),e.jsx(q,{className:"p-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx(ae,{isRecording:x==="recording",onStart:U,onStop:$,disabled:!z}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"bg-black/50 rounded-xl p-4 min-h-[100px] border border-white/10",children:p||T?e.jsxs("p",{className:"text-white text-sm whitespace-pre-wrap",children:[p,e.jsx("span",{className:"text-[#a0a0a0]",children:T})]}):e.jsx("p",{className:"text-[#a0a0a0] text-sm italic",children:x==="recording"?"Listening... Start speaking":"Click the microphone to start"})}),p&&e.jsx("div",{className:"mt-3",children:e.jsx(B,{value:k(p),max:Q,color:"blue",showLabel:!0})})]}),b&&e.jsxs(W.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full bg-[#00ff88]/10 border border-[#00ff88]/30 rounded-xl p-4",children:[e.jsx("p",{className:"text-[#00ff88] font-semibold mb-2",children:b.message}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-[#a0a0a0]",children:[e.jsxs("span",{children:["Words: ",b.wordsSpoken,"/",b.targetWords]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Time: ",b.duration,"s"]})]})]}),e.jsx("div",{className:"flex gap-3",children:x==="recorded"&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{variant:"secondary",onClick:Y,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsxs(v,{variant:"primary",onClick:K,children:["Next Question",e.jsx(ce,{className:"w-4 h-4 ml-2"})]})]})})]})})]},a.id)})})]})})]})):e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-3",children:"Browser Not Supported"}),e.jsx("p",{className:"text-[#a0a0a0] mb-6",children:"Voice practice requires the Web Speech API. Please use Chrome, Edge, or Safari."}),e.jsx(v,{onClick:()=>l("/"),children:"Go Home"})]})})}export{Ce as default};
